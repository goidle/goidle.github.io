{"componentChunkName":"component---src-templates-blog-post-js","path":"/react/in-depth-react-reconciler_2/","result":{"data":{"site":{"siteMetadata":{"title":"Deep Dive Magic Code","author":"Goidle","comment":{"utterances":"goidle/goidle.github.io"}}},"markdownRemark":{"id":"3a20b76f-2f74-5dfd-99db-ef5388a22779","excerpt":"모든 설명은 v16.12.0 버전 함수형 컴포넌트 기준입니다. 버전에 따라 코드는 변경될 수 있으며 클래스 컴포넌트는 설명에서 제외됨을 알려 드립니다. 6. Render phase render phase는 업데이트가 발생한 컴포넌트를 찾아 호출하고 반환하는 자식 react element를 fiber로 확장하여 VDOM에 적용하는 일련의 과정을 일컫습니다. 는 이미 prepareFreshStack()에서 만들어 잡아두었습니다. 만약 이 변수가 null이라면 이는 더 이상 진행할 Work…","html":"<blockquote>\n<p>모든 설명은 v16.12.0 버전 함수형 컴포넌트 기준입니다. 버전에 따라 코드는 변경될 수 있으며 클래스 컴포넌트는 설명에서 제외됨을 알려 드립니다.</p>\n</blockquote>\n<h1 id=\"6-render-phase\"><a href=\"#6-render-phase\" aria-label=\"6 render phase permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Render phase</h1>\n<p>render phase는 업데이트가 발생한 컴포넌트를 찾아 호출하고 반환하는 자식 react element를 fiber로 확장하여 VDOM에 적용하는 일련의 과정을 일컫습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber 0\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberWorkLoop.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">performSyncWorkOnRoot</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">root</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 생략..</span>\n  <span class=\"token comment\">// if (..) prepareFreshStack(root, expirationTime);</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>workInProgress <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> prevExecutionContext <span class=\"token operator\">=</span> executionContext<span class=\"token punctuation\">;</span>\n    executionContext <span class=\"token operator\">|=</span> RenderContext<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">workLoopSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>thrownValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">handleError</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> thrownValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    executionContext <span class=\"token operator\">=</span> prevExecutionContext<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// commit phase..</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 잔여 작업이 없으므로 null을 리턴.</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">workInProgress</code>는 이미 prepareFreshStack()에서 만들어 잡아두었습니다. 만약 이 변수가 null이라면 이는 더 이상 진행할 Work가 없다는 뜻이므로 render phase나 commit phase에 진입하지 않습니다.<br>\n라인 8에서 render phase에 진입했다는 걸 기록합니다. <code class=\"language-text\">workLoopSync()</code>는 Work 진입점입니다.<br>\nWork를 시작하기에 앞서 다음의 이미지를 통해 전체적인 흐름을 먼저 보고 진행하겠습니다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 790px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 47.22036168787676%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABKklEQVQoz4VS2W6DQBDj//8oH4AapEb5hR5qI+UAws0e43qGbkvVpH2wdgDb65khExEIsEBr0QooqwqbzQYP2y0edzvkeY79fo+iKFBfr8a5pc2sCGFBMowRbp5RlSXqukZTV6jLC7q25VnCDQOgfPLE+0WrdTKMTbPAOUQaxa6FtA3gHYUeGPoF0wjeAjkfEXhGGsfzidorjZ0lzSwujYRGXgkUaW3PfYdZDdxsF40Ue6aUaSK3RxgH+yaq0ZRmuJoD0jwSSIoUY/XNkr0+Q05HHdxP/tcM/4Bn+zoCa6vrEDhLd3iDu5wR+h7CroRp0w7uG663N46LiIiamu8j3wemDC9PiId3G8N3y7fA+eiiNJWlGD+hC9MF6WW62bThf1tO5HswHn79hx/bZsBJOgJy5wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"render phase flow\" title=\"render phase flow\" src=\"/static/ea0101d7212866b4c6776ee262f8160e/c94d1/render_phase_flow.png\" srcset=\"/static/ea0101d7212866b4c6776ee262f8160e/0780f/render_phase_flow.png 198w,\n/static/ea0101d7212866b4c6776ee262f8160e/47b26/render_phase_flow.png 395w,\n/static/ea0101d7212866b4c6776ee262f8160e/c94d1/render_phase_flow.png 790w,\n/static/ea0101d7212866b4c6776ee262f8160e/9e288/render_phase_flow.png 1185w,\n/static/ea0101d7212866b4c6776ee262f8160e/624a3/render_phase_flow.png 1493w\" sizes=\"(max-width: 790px) 100vw, 790px\" loading=\"lazy\">\n    </span>\n<h2 id=\"1-workloop\"><a href=\"#1-workloop\" aria-label=\"1 workloop permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. workLoop</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberWorkLoop.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">workLoopSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>workInProgress <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    workInProgress <span class=\"token operator\">=</span> <span class=\"token function\">performUnitOfWork</span><span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>concurrent mode용 workLoopConcurrent()와는 다르게 제어권을 yield하는 부분이 없으므로 동기적으로 render phase가 진행될 것이라는 걸 알 수 있습니다.<br>\n<code class=\"language-text\">workInProgress</code>는 <code class=\"language-text\">performUnitOfWork()</code>가 뱉어내는 fiber를 받습니다. 이 fiber는 다음 Work를 진행할 fiber입니다.</p>\n<h2 id=\"2-performunitofwork\"><a href=\"#2-performunitofwork\" aria-label=\"2 performunitofwork permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. performUnitOfWork</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber 0\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberWorkLoop.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">performUnitOfWork</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">unitOfWork<span class=\"token punctuation\">:</span> Fiber</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Fiber <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> current <span class=\"token operator\">=</span> unitOfWork<span class=\"token punctuation\">.</span>alternate<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> next <span class=\"token operator\">=</span> <span class=\"token function\">beginWork</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> unitOfWork<span class=\"token punctuation\">,</span> renderExpirationTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 자식 반환</span>\n\n  unitOfWork<span class=\"token punctuation\">.</span>memoizedProps <span class=\"token operator\">=</span> unitOfWork<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>next <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 더이상 자식을 반환하지 않는다면 현재 fiber를 마무리 한다.</span>\n    next <span class=\"token operator\">=</span> <span class=\"token function\">completeUnitOfWork</span><span class=\"token punctuation\">(</span>unitOfWork<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 형제 반환</span>\n  <span class=\"token punctuation\">}</span>\n\n  ReactCurrentOwner<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> next<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">next</code>는 다음 Work를 진행할 fiber입니다.<br>\n라인 5의 <code class=\"language-text\">beginWork()</code>는 컴포넌트를 실행해 자식을 반환하고 라인9의 <code class=\"language-text\">completeUnitOfWork()</code>는 형제를 반합니다.<br>\n라인 7에서는 beginWork()가 끝나면 해당 fiber의 props로 인한 변화를 모두 적용한 상태이기 때문에 확정지어 줍니다. </p>\n<blockquote>\n<p>props가 영향을 받거나 주는 경우는 부모가 리-렌더되어 props가 변경될 때와 props를 이용하여 자식을 컨트롤할 때입니다.<br>\n두가지 케이스에 해당하지 않음을 알 수 있다면 props를 확정지을 수 있습니다.<br>\nperformUnitOfWork()가 호출될 때의 상황을 보면 unitOfWork의 부모는 이미 unitOfWork를 반환한 상태이므로 부모에게 넘겨받는 props가 변경될 일은 없습니다.<br>\n또한 beginWork()가 끝났다면 자신도 마찬가지로 자식을 반환한 후 이므로 더이상 props로 영향을 줄 만한 상황이 남아있지 않습니다.</p>\n</blockquote>\n<h2 id=\"3-beginwork\"><a href=\"#3-beginwork\" aria-label=\"3 beginwork permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. beginWork</h2>\n<p>beginWork()의 목적은 컴포넌트를 실행해야 하는지 판단하는 겁니다. 그렇다면 어떤 상황일때 컴포넌트를 실행해야하고 반대로 실행하지 말아야 할까요?\n다음 두가지에 해당하면 컴포넌트를 실행해야 합니다.<br>\n첫번째는 사용자가 컴포넌트의 상태를 변경했을 때 두번째는 props가 변경될 때 입니다.  </p>\n<h3 id=\"컴포넌트-상태-변경-판단\"><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%83%81%ED%83%9C-%EB%B3%80%EA%B2%BD-%ED%8C%90%EB%8B%A8\" aria-label=\"컴포넌트 상태 변경 판단 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컴포넌트 상태 변경 판단</h3>\n<p>현재 처리하고 있는 fiber가 상태가 변경된 컴포넌트인지 어떻게 판단할까요?\n복잡하게 생각하지 말고 그냥 업데이트가 발생한 컴포넌트에 flag 하나만 달면 되지 않을까요? 우리는 이 장치를 이미 <a href=\"/react/in-depth-react-scheduler_1#markUpdateTimeFromFiberToRoot()()()()\" target=\"_blank\">markUpdateTimeFromFiberToRoot()</a>를 통해 해놨습니다. 그것도 두개나 설정해놨습니다. 바로 expirationTime과 childExpirationTime입니다.  </p>\n<p>업데이트가 발생한 fiber에는 expirationTime를 해당 컴포넌트의 부모 부터 host root까지는 childExpirationTime을 설정했습니다. 이는 상태가 변경된 컴포넌트를 찾는데 사용됩니다. 현재 fiber에 childExpirationTime가 설정되어 있다면 해당 컴포넌트는 실행하지 않고 그저 하위 자식만 반환하면 됩니다. 이를 반복하여 expirationTime이 renderExpirationTime과 같은 컴포넌트를 찾습니다. 이 컴포넌트가 현재 진행하는 Work를 발생시킨 주체이며 재호출이 필요한 컴포넌트이기 때문입니다.</p>\n<h3 id=\"props-변경-판단\"><a href=\"#props-%EB%B3%80%EA%B2%BD-%ED%8C%90%EB%8B%A8\" aria-label=\"props 변경 판단 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>props 변경 판단</h3>\n<anchor id=\"question1\">\n<p>props가 변경된 경우는 부모의 리-렌더 밖에 없습니다. 당연히 부모가 호출되었으니 자식도 호출 되겠죠? 왜 당연할까요? 단순히 다음과 같이 정의된 자식도 부모가 리-렌더링되면 재 호출 될까요? </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">FC</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>  </code></pre></div>\n<p>대답은 다음 코드를 보면서 하도록 하겠습니다. 이미 답을 알고 계신분들도 있지만 아마 그 중에서도 왜 그런지 정확히 모르시는 분들도 계실겁니다.</p>\n<h3 id=\"beginwork\"><a href=\"#beginwork\" aria-label=\"beginwork permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>beginWork()</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber 0\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">beginWork</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">current<span class=\"token punctuation\">:</span> Fiber <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  workInProgress<span class=\"token punctuation\">:</span> Fiber<span class=\"token punctuation\">,</span>\n  renderExpirationTime<span class=\"token punctuation\">:</span> ExpirationTime<span class=\"token punctuation\">,</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Fiber <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> updateExpirationTime <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>expirationTime<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 마운트가 아닌 업데이트 환경인지 판단</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>current <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> oldProps <span class=\"token operator\">=</span> current<span class=\"token punctuation\">.</span>memoizedProps<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> newProps <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// props 변경 판단</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>oldProps <span class=\"token operator\">!==</span> newProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      didReceiveUpdate <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Work를 진행해야 하는 fiber인지 판단</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>updateExpirationTime <span class=\"token operator\">&lt;</span> renderExpirationTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      didReceiveUpdate <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Work를 시작하지 않고 자식의 workInProgress만 만들어 반환</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">bailoutOnAlreadyFinishedWork</span><span class=\"token punctuation\">(</span>\n        current<span class=\"token punctuation\">,</span>\n        workInProgress<span class=\"token punctuation\">,</span>\n        renderExpirationTime<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token comment\">// 상태가 변경된 컴포넌트</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      didReceiveUpdate <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 마운트 환경</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    didReceiveUpdate <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  workInProgress<span class=\"token punctuation\">.</span>expirationTime <span class=\"token operator\">=</span> NoWork<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Work 시작</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">.</span>tag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 생략..</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p><code class=\"language-text\">didReceiveUpdate</code>는 컴포넌트의 업데이트를 나타냅니다. 여기서 업데이트란 컴포넌트의 props, state 변경을 뜻합니다.  </p>\n</blockquote>\n<p>라인 41에 진입하면 컴포넌트를 호출하고 반대로 라인 18에 진입하면 컴포넌트는 호출하지 않고 자식만 반환하는 흐름이라는걸 인지하시고 설명을 보시길 바랍니다.  </p>\n<ul>\n<li>9: current가 없다면 현재 fiber는 마운트되고 있다는 뜻입니다.  </li>\n<li>30: 마운트이므로  <code class=\"language-text\">didReceiveUpdate</code>는 false입니다.  </li>\n<li>14: 마운트가 아닌 업데이트라면 먼저 현재 컴포넌트를 호출해야 되는지 판단해야 합니다. 판단 조건은 이전에 설명한 그대로입니다. 해당 라인에서 props를 레퍼런스 비교로 체크하고 있습니다. <down>(이 부분만으로는 <a href=\"#question1\">위 질문</a>에 대한 자세한 대답을 하기에는 충분하지 않습니다.)</down>  </li>\n<li>\n<p>18: 이해를 위해 다음 조건을 하나씩 한번만 더 짚어 보겠습니다. <code class=\"language-text\">updateExpirationTime &lt; renderExpirationTime</code><br>\nupdateExpirationTime은 이벤트가 발생한 시점에 fiber에 새겨진 expirationTime이고 renderExpirationTime는 root에 새겨진 expirationTime으로 현재 Work를 발생시킨 이벤트의 시간입니다.<br>\nexpirationTime은 일반적인 시간과는 반대로 큰 수가 더 이전 시간입니다.<br>\n위 내용들을 바탕으로 조건을 해석하자면 Work를 발생시킨 expirationTime이 현재 workInProgress의 expirationTime 보다 더 이전에 발생한 것이라면 현재 fiber는 지금 처리해야할 차례가 아닙니다.   </p>\n<blockquote>\n<p>못 보고 지나치신 분들을 위해 <code class=\"language-text\">renderExpirationTime</code>은 <a href=\"/react/in-depth-react-reconciler_1#prepareFreshStack\" target=\"_blank\">다음</a>에서 설정되었으며\n컴포넌트 리-렌더링을 통해 만들어진 자식 fiber들은 기본적으로 expirationTiem은 noWork(0)입니다. 그래서 항상 <u>renderExpirationTime 보다 작습니다.</u></p>\n</blockquote>\n</li>\n<li>22: <code class=\"language-text\">bailoutOnAlreadyFinishedWork()</code>는 자식의 workInProgress를 만들어 반환합니다.</li>\n<li>30: 해당 컴포넌트에서 Work가 발생하였지만<up>18</up> 마운트하는 상황은 아니고<up>9</up> props도 변경된 것이 없음을 나타냅니다.</li>\n<li>41: fiber의 종류에 맞게 Work를 시작합니다. 이 부분은 라인 22의 bailoutOnAlreadyFinishedWork()를 먼저 확인하고 진행하겠습니다.</li>\n</ul>\n<h3 id=\"bailoutonalreadyfinishedwork\"><a href=\"#bailoutonalreadyfinishedwork\" aria-label=\"bailoutonalreadyfinishedwork permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>bailoutOnAlreadyFinishedWork()</h3>\n<p>재조정 작업은 root node부터 시작하여 상태가 변경된 컴포넌트까지 순회하며 workInProgress 트리를 만들어 갑니다.<br>\n이중에는 변경된 컴포넌트를 제외한 나머지는 굳이 특별한 처리 없이 cururent를 재사용하여 workInProgress만 만들면 됩니다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberBeginWork.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">bailoutOnAlreadyFinishedWork</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">current<span class=\"token punctuation\">:</span> Fiber <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  workInProgress<span class=\"token punctuation\">:</span> Fiber<span class=\"token punctuation\">,</span>\n  renderExpirationTime<span class=\"token punctuation\">:</span> ExpirationTime<span class=\"token punctuation\">,</span></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Fiber <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">var</span> updateExpirationTime <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>expirationTime<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> childExpirationTime <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>childExpirationTime<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>childExpirationTime <span class=\"token operator\">&lt;</span> renderExpirationTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cloneChildFibers</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> workInProgress<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>if문에서는 자손에서 업데이트가 발생했는지 확인합니다. 만약 그렇다면 cloneChildFibers()을 통해 workInProgress를 만들어 주고 그렇지 않다면 불필요한 workInProgress 트리를 만들 필요가 없으므로 null을 리턴하며 부모의 Work를 마무리할 수 있도록 해줍니다.  </p>\n<p>cloneChildFibers()는 workInPregress를 만드므로 상당부분 prepareFreshStack()과 유사합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactChildFiber.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">cloneChildFibers</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">current<span class=\"token punctuation\">:</span> Fiber <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  workInProgress<span class=\"token punctuation\">:</span> Fiber<span class=\"token punctuation\">,</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">.</span>child <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 첫번째 자식 복사</span>\n  <span class=\"token keyword\">let</span> currentChild <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> newChild <span class=\"token operator\">=</span> <span class=\"token function\">createWorkInProgress</span><span class=\"token punctuation\">(</span>\n    currentChild<span class=\"token punctuation\">,</span>\n    currentChild<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">,</span>\n    currentChild<span class=\"token punctuation\">.</span>expirationTime<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  workInProgress<span class=\"token punctuation\">.</span>child <span class=\"token operator\">=</span> newChild<span class=\"token punctuation\">;</span>\n  newChild<span class=\"token punctuation\">.</span>return <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 첫 번째 자식 형제들의 workInProgress를 만들어 다시 엮어줌</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>currentChild<span class=\"token punctuation\">.</span>sibling <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    currentChild <span class=\"token operator\">=</span> currentChild<span class=\"token punctuation\">.</span>sibling<span class=\"token punctuation\">;</span>\n    newChild <span class=\"token operator\">=</span> newChild<span class=\"token punctuation\">.</span>sibling <span class=\"token operator\">=</span> <span class=\"token function\">createWorkInProgress</span><span class=\"token punctuation\">(</span>\n      currentChild<span class=\"token punctuation\">,</span>\n      currentChild<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">,</span>\n      currentChild<span class=\"token punctuation\">.</span>expirationTime<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    newChild<span class=\"token punctuation\">.</span>return <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  newChild<span class=\"token punctuation\">.</span>sibling <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>prepareFreshStack()과 다른부분은 Work와 관련된 전역변수 처리 코드가 없습니다. 대신 현재 fiber의 하위 자식의 workInProgress를 만들어 엮어주는 코드가 추가적으로 존재합니다.</p>\n<blockquote>\n<p>createWorkInProgress()는 <a href=\"/react/in-depth-react-reconciler_1#prepareFreshStack\" target=\"_blank\">prepareFreshStack()</a>에서 이미 다루었기 때문에 생략합니다.</p>\n</blockquote>\n<p><a href=\"/react/in-depth-react-reconciler_1/#todo\" target=\"_blank\">Todo</a>예제에서 Input 컴포넌트의 상태가 바뀌었다고 가정을 하면 VDOM의 형태는 다음과 같을 것입니다.</p>\n<figure>\n <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 758px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 53.95778364116095%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABt0lEQVQoz52SWW/aUBCF+f9/oFIf24eqEi9RS7qlrRQ1UVJUKCGUzY5cYzBeABtsxzY2X+e6G1GDInWkI4/uXJ85c8/Udrsd/wMVebFFm9us12vKoqjOavsX7ot7CcuyqhV5jtHt4Louvu+TpulfwlyKmSD/hej2llgulAeaFUXJdrslFCJd0xiNRqyWS2o/iwWWZTGdTvGk29j8zpOPJ9Qvzlj5HkUYkAUrstWKXPLImTP+cML1yyN8a0IUJ4RBUPFUCksZYbPZVIhFmS/fT1dtWqNvxHFMLkgFmcqThER+Hpyd8vVtg1ia7EelUBEqdTPbJrKmWDc6R63PvOq0CRcuJDFFtCFfh2xVUxnTuDhHP31PtFjwm0OJq6l3CNRI8l6BKHh+3OCpjGIYOs5kQvOqxZfrDr1Bn7lh4E5MbG1M93WDZv0ZjjS/Q6iSypA0w3VsejdDuvoIY9jFE8KZZTIRcndmiTKPZLlgI6viDQd4YkYiqve34c/IL5qXPHrToN3vCfo8fndM/fK8cvuh2F+pijDLMgxxWVNOOw4zcVET93TTFAfjOyPt7+I/Z4rwocU+uNwH8APW5kds8EiVxQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"input update\" title=\"input update\" src=\"/static/f71ef923eb25f3890f79a6f45afd223c/20362/input_update.png\" srcset=\"/static/f71ef923eb25f3890f79a6f45afd223c/0780f/input_update.png 198w,\n/static/f71ef923eb25f3890f79a6f45afd223c/47b26/input_update.png 395w,\n/static/f71ef923eb25f3890f79a6f45afd223c/20362/input_update.png 758w\" sizes=\"(max-width: 758px) 100vw, 758px\" loading=\"lazy\">\n    </span>\n <figcaption>bailoutOnAlreadyFinishedWork()&#xB97C; &#xD1B5;&#xD574; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C0;&#xB294; workInProgress &#xD2B8;&#xB9AC;</figcaption>\n</figure>\n<p>위 이미지에서 보여지는 workInProgress들은 모두 current를 재활용 한 것입니다. 그래서 Input의 child도 자동으로 input을 바라보고 있습니다. current를 복제한 후 변경하는 속성은 return 밖에 없으며 부모의 workInProgress를 가리키도록하기 위함입니다.  </p>\n<h3 id=\"경로-최적화\"><a href=\"#%EA%B2%BD%EB%A1%9C-%EC%B5%9C%EC%A0%81%ED%99%94\" aria-label=\"경로 최적화 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>경로 최적화</h3>\n<p>이제는 <a href=\"#question1\">질문에</a> 대답을 할 수 있는 지식들을 가지고 있습니다.  </p>\n<ol>\n<li>props가 변경되면 해당 컴포넌트를 호출한다.</li>\n<li>props가 변경되지 않았으면 자손의 상태 변경 여부에 따라 workInProgress를 반환하거나 null을 반환한다.</li>\n<li>JSX는 <a href=\"/react/in-depth-react-reconciler_1#createElement\" target=\"_blank\">createElement()</a>로 변환된다. 이때 props 객체를 새로 생성해서 사용한다.</li>\n</ol>\n<p>질문에 대답을 해봅시다. 만약 부모의 상태가 변경되어 리-렌더링 된다. 그러면 그 자식들은 모두 createElement를 통해 react element로 반환될 것입니다. 그리고 3번에 의거해서 props를 부모에서 받지 않아도 새로운 빈 객체가 할당됩니다.<br>\n이제 다음 Work는 이때 반환한 자식 fiber입니다. 그리고 props를 레퍼런스로 비교하게 되면 당연히 이전 props와는 다른 객체이므로 1번에 의해 해당 자식은 재 호출 될 것입니다.<br>\n그리고 Work는 root node부터 시작하지만 재 호출하는 로직이 없으므로 props는 같습니다. 그래서 2번에 의해 자손에서 업데이트가 발생한 fiber만 workInProgress를 만들고 그렇지 않은 fiber는 null을 통해 서브 current 트리를 workInProgress 트리로 만들지 않도록 합니다. 다시 말하지만 여기서 다루어지는 모든 fiber들은 재호출 하지 않습니다.  </p>\n<p>대답이 되시나요? 다시 요약해서 말하자면 재호출 되는 컴포넌트의 자식들은 props를 받던 받지 않던 모두 재호출 될 것입니다. 부모는 트리 순회 대상에는 해당하지만 재호출에서는 제외된다. 라고 결론 지으면 될 것 같습니다.</p>\n<p><u>여기에 매우 중요한 힌트가 있습니다. </u><br>\n리액트의 동작 흐름에서 유일하게 개발자에게 개입할 수 있는 성능 최적화 기회를 딱 한번 쥐어줍니다. 바로 경로 최적화 입니다. 이 부분은 리액트보다 개발자가 더 잘 판단할 것으로 생각하고 리액트에서 쓸데없는 연산을 하지 않도록 양보합니다.  </p>\n<p>경로 최적화의 핵심은 props를 변경하지 않도록 하는 겁니다. 당연히 상태가 변경된 컴포넌트는 재호출 하지만 그 이외의 컴포넌트들은 props만 변경되지 않는다면 절대로 재호출 되는 일은 없습니다. 이를 이용하여 함수형 컴포넌트에서는 <a href=\"https://ko.reactjs.org/docs/react-api.html#reactmemo\" target=\"_blank\">memo</a>를 제공합니다.  </p>\n<p>부모가 아무리 재호출 되어도 자식이 넘겨받는 props가 얕은 비교를 하여 변경되지 않았다면 bailoutOnAlreadyFinishedWork()을 통해 빠져나가도록 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberBeginWork.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateSimpleMemoComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 생략..</span>\n  <span class=\"token keyword\">const</span> prevProps <span class=\"token operator\">=</span> current<span class=\"token punctuation\">.</span>memoizedProps<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">shallowEqual</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    didReceiveUpdate <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>updateExpirationTime <span class=\"token operator\">&lt;</span> renderExpirationTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">bailoutOnAlreadyFinishedWork</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 컴포넌트 Work 시작</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>memo를 이용한 최적화는 공식 홈페이지에서 자세히 확인 할 수 있으므로 생략합니다.</p>\n</blockquote>\n<p>만약 memo가 없었다면 상태가 변경된 컴포넌트의 자식들은 얄짤없이 모두 리-렌더링 될 것입니다. 트리의 깊이가 깊거나 혹은 자식이 매우 많을 경우 성능에 영향을 미치므로 경로 최적화가 필요한 시점이 됩니다.  </p>\n<p>여기서 memo를 제외하고 최적화 할 수 있는 방법이 한가지 더 있습니다. 어떻게 하면 부모가 재 호출되는데 자식의 props가 변경되지 않도록 할 수 있을까요?  </p>\n<anchor id=\"list_up\">\n<p>바로 createElement() 호출을 회피하면 됩니다. 경로 최적화를 하고 싶은 자식만 부모의 부모로 lift up 한다면 해당 자식은 부모의 재 호출에 더이상 props가 변경될 일은 없습니다. 다음의 <a href=\"/react/in-depth-react-reconciler_1#todo\" target=\"_blank\">Todo</a> 예제를 살짝 변형시킨 후 Input의 button을 lift up 해보면서 확인하도록 하겠습니다.</p>\n<blockquote>\n<p>경로 최적화가 매번 성능 향상으로 직결되지는 않습니다. 깊이가 얕거나 자식을 몇 소유하지 않은 컴포넌트라면 굳이 경로 최적화를 생각하며 개발할 필요가 없다는 뜻이며 이번 실습은 보여주기 위한 진행임을 인지하시길 바랍니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 변경 전</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>input value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span> onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Button<span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">SubmitBtn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Button 호출'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>button<span class=\"token operator\">></span>submit<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 변경 후</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Todo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todos<span class=\"token punctuation\">,</span> push<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Input SubmitBtn<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">&lt;</span>SubmitBtn <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Input<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>OrderList list<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>todos<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Input</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> SubmitBtn <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>input value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span> onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>SubmitBtn<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<figure>\n <img src=\"/path/to/dir/dce8ded43716c3c340ed1a2256403f96/before_lift_up.gif\" height=\"300px\" width=\"100%\">\n  <figcaption>&#xBCC0;&#xACBD; &#xC804;</figcaption>\n</figure>\n<figure>\n <img src=\"/path/to/dir/b6af852cfc86fe335c7b7a8ccc1bd33d/after_lift_up.gif\" height=\"300px\" width=\"100%\">\n  <figcaption>&#xBCC0;&#xACBD; &#xD6C4;</figcaption>\n</figure>\n<h3 id=\"경로-최적화시-자주하는-실수\"><a href=\"#%EA%B2%BD%EB%A1%9C-%EC%B5%9C%EC%A0%81%ED%99%94%EC%8B%9C-%EC%9E%90%EC%A3%BC%ED%95%98%EB%8A%94-%EC%8B%A4%EC%88%98\" aria-label=\"경로 최적화시 자주하는 실수 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>경로 최적화시 자주하는 실수</h3>\n<p>memo를 이용하여 경로 최적화를 할 때 개발자분들이 자주하는 실수가 하나 있습니다. 다음의 두 가지 유의사항이 개발자들을 실수로 이끕니다.</p>\n<ol>\n<li>컴포넌트는 업데이트가 발생할 때마다 재호출 된다.</li>\n<li>memo는 얇은 비교로 props 변경을 판단한다.</li>\n</ol>\n<p>만약 이벤트 핸들러나 자료구조를 컴포넌트 안에서 선언했다면 이때는 재호출 때마다 이들의 레퍼런스가 변하게 됩니다. 당연히 memo로 넘어가면 얕은 비교를 통해 같지않다는 결과가 나올 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>Button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Button click!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>\n<p>memo는 두번째 인자로 비교 전략을 교체할 수 있도록 해줍니다. 그래서 객체의 경우 얕은 비교가 아닌 다른 전략을 통해 해결할 수도 있습니다. 하지만 문제는 함수입니다.  </p>\n<p>이벤트 핸들러 선언을 컴포넌트 안이 아닌 밖으로 빼내어 딱 한번만 정의하면 될까요? 이는 바로 난관에 봉착할 것입니다. 이벤트 핸들러에서 컴포넌트의 상태를 클로저로 의존하고 있다면 말입니다.  </p>\n<p>이때 사용하라고 만든 것이 <a href=\"https://ko.reactjs.org/docs/hooks-reference.html#usecallback\" target=\"_blank\">useCallback()</a>입니다.<br>\n이를 이용하여 이벤트 핸들러가 의존하고 있는 값들이 변할때에만 새로운 핸들러를 만들도록 할 수 있습니다.  </p>\n<h3 id=\"work-시작\"><a href=\"#work-%EC%8B%9C%EC%9E%91\" aria-label=\"work 시작 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Work 시작</h3>\n<p>다시 beginWork()로 돌아가서 이어서 Work 시작 코드를 진행하도록 하겠습니다. switch 문에서 호출하는 함수들은 모두 컴포넌트를 실행해 자식을 반환 받는 역할을 하는 함수들이라는 걸 생각하시고 보시는게 이해하기 편합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber 0\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberBeginWork.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">beginWork</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 생략..</span>\n  <span class=\"token comment\">// workInProgress.expirationTime = NoWork;</span>\n\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">.</span>tag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> IndeterminateComponent<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">mountIndeterminateComponent</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">case</span> FunctionComponent<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 생략..</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">updateFunctionComponent</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">case</span> HostComponent<span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">updateHostComponent</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> Fragment<span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">updateFragment</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// HostRoot, LazyComponent, Memo, ClassComponent...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>자주 접하게 되는 컴포넌트에 대해서만 진행하도록 하겠습니다.  </p>\n<h3 id=\"indeterminatecomponent\"><a href=\"#indeterminatecomponent\" aria-label=\"indeterminatecomponent permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IndeterminateComponent</h3>\n<p>먼저 <code class=\"language-text\">IndeterminateComponent</code>는 <a href=\"/react/in-depth-react-reconciler_1#createFiberFromTypeAndProps\" target=\"_blank\">createFiberFromTypeAndProps()</a>에서 처음 fiber를 만들때 초기 tag값으로 설정해주었습니다. 그 후에 fiber 종류에 맞는 tag를 찾아 설정해주었지만 함수만은 <a href=\"/react/in-depth-react-reconciler_1#IndeterminateComponent\" target=\"_blank\">다음</a>과 같은 이유로 그러지 못했습니다.  </p>\n<p>이제는 이 함수를 실행해 tag를 결정지을 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber 0\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberBeginWork.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">mountIndeterminateComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> renderExpirationTime</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> props <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token function\">renderWithHooks</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n    workInProgress<span class=\"token punctuation\">,</span>\n    Component<span class=\"token punctuation\">,</span>\n    props<span class=\"token punctuation\">,</span>\n    context<span class=\"token punctuation\">,</span>\n    renderExpirationTime<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  workInProgress<span class=\"token punctuation\">.</span>effectTag <span class=\"token operator\">|=</span> PerformedWork<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">typeof</span> value <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span> <span class=\"token operator\">&amp;&amp;</span>\n    value <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span>\n    <span class=\"token keyword\">typeof</span> value<span class=\"token punctuation\">.</span>render <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span> <span class=\"token operator\">&amp;&amp;</span>\n    value<span class=\"token punctuation\">.</span>$$<span class=\"token keyword\">typeof</span> <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 클래스 컴포넌트 처리..</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    workInProgress<span class=\"token punctuation\">.</span>tag <span class=\"token operator\">=</span> FunctionComponent<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">reconcileChildren</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> renderExpirationTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> workInProgress<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>드디어 hooks를 분석할 때 보았던 <a href=\"/react/in-depth-react-hooks_1#renderWithHooks()\">renderWithHooks()</a>가 나왔습니다.<br>\n라인 21에서는 함수를 클래스 컴포넌트로 변환하고 반환받은 <code class=\"language-text\">value</code>를 해당 함수의 인스턴스로 갈아치우는 코드가 생략되어 있습니다.<br>\n함수형의 경우 <code class=\"language-text\">value</code>는 자식 react element이므로 fiber로 확장하는 작업을 진행합니다.</p>\n<blockquote>\n<p>reconcileChildren() 모든 fiber들이 공통으로 사용하는 함수이므로 맨 마지막에 확인하도록 하겠습니다.</p>\n</blockquote>\n<h3 id=\"functioncomponent\"><a href=\"#functioncomponent\" aria-label=\"functioncomponent permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FunctionComponent</h3>\n<p>함수형 컴포넌의 Work를 진행하기에 앞서 default props를 먼저 처리해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">beginWork</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 생략..</span>\n  <span class=\"token comment\">// workInProgress.expirationTime = NoWork;</span>\n\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>workInProgress<span class=\"token punctuation\">.</span>tag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 생략..</span>\n    <span class=\"token keyword\">case</span> FunctionComponent<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> Component <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> unresolvedProps <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> resolvedProps <span class=\"token operator\">=</span>\n        workInProgress<span class=\"token punctuation\">.</span>elementType <span class=\"token operator\">===</span> Component\n          <span class=\"token operator\">?</span> unresolvedProps\n          <span class=\"token punctuation\">:</span> <span class=\"token function\">resolveDefaultProps</span><span class=\"token punctuation\">(</span>Component<span class=\"token punctuation\">,</span> unresolvedProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token function\">updateFunctionComponent</span><span class=\"token punctuation\">(</span>\n        current<span class=\"token punctuation\">,</span>\n        workInProgress<span class=\"token punctuation\">,</span>\n        Component<span class=\"token punctuation\">,</span>\n        resolvedProps<span class=\"token punctuation\">,</span>\n        renderExpirationTime<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// 생략..</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// reconciler > ReactLazyComponent.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">resolveDefaultProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Component<span class=\"token punctuation\">,</span> baseProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Component <span class=\"token operator\">&amp;&amp;</span> Component<span class=\"token punctuation\">.</span>defaultProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> props <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> baseProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> defaultProps <span class=\"token operator\">=</span> Component<span class=\"token punctuation\">.</span>defaultProps<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> propName <span class=\"token keyword\">in</span> defaultProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        props<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> defaultProps<span class=\"token punctuation\">[</span>propName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> props<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> baseProps<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이제 함수를 실행해 업데이트를 반영한 자식들을 만들어낼 차례입니다.<br>\n이때 최적화 할 수 있는 상황이 하나 존재합니다. 만약 props가 변경되지 않은 컴포넌트를 호출했는데 이 호출에서도 상태가 이전 상태와 같다면? 이때도 마찬가지로 이전 current를 재사용하기만 하면 됩니다.<br>\nprops의 변경을 나타내는 flag로 <code class=\"language-text\">didReceiveUpdate</code>를 사용했었습니다. 상태 또한 해당 flag를 같이 사용합니다. 그리고 훅을 다룰 때 상태가 변경되었을 때 해당 flag를 설정하는 코드를 여기에서 설명하려고 생략했었습니다. 생략된 코드는 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is</span><span class=\"token punctuation\">(</span>newState<span class=\"token punctuation\">,</span> hook<span class=\"token punctuation\">.</span>memoizedState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">markWorkInProgressReceivedUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// didReceiveUpdate = true;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>만약 함수를 실행했는데도 didReceiveUpdate가 계속해서 false라면 해당 컴포넌트는 훅을 통해 상태를 업데이트 했지만 이전 상태와 변한게 없다는 뜻입니다. props, state 모두 변경되지 않았으면 해당 컴포넌트의 서브 트리들은 이전과 같을겁니다.<br>\n이때 한가지 처리해야 할 부분이 하나 남아있습니다. 일단 한번의 호출은 불가피한데 이때 만약 useEffect, layoutEffect가 사용되었다면 불필요한 콜백들이 실행될 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber 0\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReractFiberBeginWork.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateFunctionComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">,</span> renderExpirationTime</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">let</span> nextChildren <span class=\"token operator\">=</span> <span class=\"token function\">renderWithHooks</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> Component<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> renderExpirationTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>current <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>didReceiveUpdate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">bailoutHooks</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> renderExpirationTime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 훅과 관련된 부분들을 초기화</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">bailoutOnAlreadyFinishedWork</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  workInProgress<span class=\"token punctuation\">.</span>effectTag <span class=\"token operator\">|=</span> PerformedWork<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">reconcileChildren</span><span class=\"token punctuation\">(</span>\n    current<span class=\"token punctuation\">,</span>\n    workInProgress<span class=\"token punctuation\">,</span>\n    nextChildren<span class=\"token punctuation\">,</span>\n    renderExpirationTime<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> workInProgress<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>6: 업데이트 환경이면서 props, state가 변경되지 않았다면 batilout만 해주면 됩니다.</li>\n<li>11: Work를 진행했다면 effect tag를 달아줍니다. completeWork()에서 사용되기 때문에 이 tag를 기억해주세요.</li>\n</ul>\n<blockquote>\n<p>bailoutOnAlreadyFinishedWork()는 확인 했고 reconcileChildren()는 추후에 확인할 것이기 때문에 여기서는 생략합니다.</p>\n</blockquote>\n<p>bailoutHooks()에서 어떤 부분들을 초기화 하는지 확인하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber 0\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberHooks.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">bailoutHooks</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> expirationTime</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  workInProgress<span class=\"token punctuation\">.</span>updateQueue <span class=\"token operator\">=</span> current<span class=\"token punctuation\">.</span>updateQueue<span class=\"token punctuation\">;</span> <span class=\"token comment\">// </span>\n  workInProgress<span class=\"token punctuation\">.</span>effectTag <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span>PassiveEffect <span class=\"token operator\">|</span> UpdateEffect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">.</span>expirationTime <span class=\"token operator\">&lt;=</span> expirationTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    current<span class=\"token punctuation\">.</span>expirationTime <span class=\"token operator\">=</span> NoWork<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>함수형 컴포넌트의 fiber는 <code class=\"language-text\">updateQueue</code>에 라이프 사이클과 관련된 훅들을 저장합니다. 호스트 컴포넌트의 경우 updateQueue에는 변경된 attribute가 저장됩니다.<br>\n라인 3, 4에서 라이프 사이클과 관련된 부분들을 초기화 하는 코드입니다.\nWork도 진행했으므로 해당 컴포넌트에는 더이상 처리할 부분이 없으므로 <code class=\"language-text\">expirationTime</code>을 NoWork로 초기화 합니다.</p>\n<blockquote>\n<p><code class=\"language-text\">updateQueue</code>와 <code class=\"language-text\">PassiveEffect</code>, <code class=\"language-text\">UpdateEffect</code> 모두 effect 훅에서 사용되는 정보들이기 때문에 useEffect(), layoutEffect()를 분석하고 확인해야 이해가 되는 부분입니다. 하지만 지금 여기서 effect 훅을 다루기에는 적절한 타이밍이 아니므로 commit phase까지 넘어가서 effect 훅들이 사용되는 모든 코드들을 확인하고 난 후에 분석하도록 하겠습니다.</p>\n</blockquote>\n<h3 id=\"hostcomponent\"><a href=\"#hostcomponent\" aria-label=\"hostcomponent permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HostComponent</h3>\n<p>호스트 컴포넌트는 호출한다는 개념이 없습니다. 커스텀 컴포넌트의 경우 상태값을 가지고 있기 때문에 호출을 해야하지만 호스트 컴포넌트는 뷰 그 자체이므로 네이티브와 관련된 처리들이 필요합니다. 호스트 컴포넌트 중에 문자열만을 받거나나 또는 자식으로 문자열 하나만 가지고 있는 경우 해당 문자열을 굳이 fiber로 만들지 않습니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberBeginWork.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateHostComponent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> renderExpirationTime</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> type <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> nextProps <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> prevProps <span class=\"token operator\">=</span> current <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">?</span> current<span class=\"token punctuation\">.</span>memoizedProps <span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> nextChildren <span class=\"token operator\">=</span> nextProps<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> isDirectTextChild <span class=\"token operator\">=</span> <span class=\"token function\">shouldSetTextContent</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isDirectTextChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    nextChildren <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 문자열을 fiber로 만들지 않기 위해 초기화</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevProps <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">shouldSetTextContent</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// current가 isDirectTextChild일 경우 자식을 fiber로 만들지 않았기 때문에</span>\n    <span class=\"token comment\">// nextChildren  삽입전에 초기화 해주기 위해 tag를 설정함</span>\n    workInProgress<span class=\"token punctuation\">.</span>effectTag <span class=\"token operator\">|=</span> ContentReset<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">reconcileChildren</span><span class=\"token punctuation\">(</span>\n    current<span class=\"token punctuation\">,</span>\n    workInProgress<span class=\"token punctuation\">,</span>\n    nextChildren<span class=\"token punctuation\">,</span>\n    renderExpirationTime<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> workInProgress<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"fragment\"><a href=\"#fragment\" aria-label=\"fragment permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fragment</h3>\n<p>Fragment는 이미 다루었지만 매우 간단하고 자주 접하므로 상기시키기위해 코드만 보고 가도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// reconciler > ReactFiberBeginWork.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateFragment</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current<span class=\"token punctuation\">,</span> workInProgress<span class=\"token punctuation\">,</span> renderExpirationTime</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> nextChildren <span class=\"token operator\">=</span> workInProgress<span class=\"token punctuation\">.</span>pendingProps<span class=\"token punctuation\">;</span> <span class=\"token comment\">// fragment는 props 자체가 자식 저장소이다</span>\n  <span class=\"token function\">reconcileChildren</span><span class=\"token punctuation\">(</span>\n    current<span class=\"token punctuation\">,</span>\n    workInProgress<span class=\"token punctuation\">,</span>\n    nextChildren<span class=\"token punctuation\">,</span>\n    renderExpirationTime<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> workInProgress<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>fiber 종류에 따라서 호출하는 함수들을 대충 알아보았고 이제부터 호출을 통해 반환받은 react element를 어떻게 fiber로 확장하는지 다음 포스터에서 reconcileChildren()을 통해 알아보겠습니다.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">목록</th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">4</td>\n<td align=\"center\"><a href=\"/react/in-depth-react-reconciler_1/\">React 톺아보기- 04. Reconciler_1</a></td>\n</tr>\n<tr>\n<td align=\"center\">6</td>\n<td align=\"center\"><a href=\"/react/in-depth-react-reconciler_3/\">React 톺아보기- 05. Reconciler_3</a></td>\n</tr>\n</tbody>\n</table>","frontmatter":{"title":"React 톺아보기- 05. Reconciler_2","date":"2020-07-02","keywords":["리액트","react","fiber","VDOM","reconciler"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/react/in-depth-react-reconciler_2/","previous":{"fields":{"slug":"/react/in-depth-react-reconciler_1/"},"frontmatter":{"title":"React 톺아보기- 05. Reconciler_1","category":"react"}},"next":null}}}