<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, minimum-scale=1, maximum-scale=2"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:Catamaran;font-weight:800;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.2;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:56px;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:20px;color:inherit;font-family:Catamaran;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.2;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:6px;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:hsla(0,0%,0%,0.53);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:2px;}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:#0687f0;text-decoration:none;box-shadow:none;}a:hover,a:active{text-decoration:underline;}a.gatsby-resp-image-link{box-shadow:none;text-decoration:none;}a:hover{text-decoration:none;}</style><style data-href="/styles.1fe9dd6b69ff480c8019.css" id="gatsby-global-css">@import url(https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css);@font-face{font-family:Noto Sans KR;font-style:normal;font-display:swap;font-weight:100;src:local("Noto Sans KR Thin "),local("Noto Sans KR-Thin"),url(/static/noto-sans-kr-latin-100-2de137ca3e12ea146ee47485a97f1e78.woff2) format("woff2"),url(/static/noto-sans-kr-latin-100-b965647685dd9fc531d1f8a1cc25e024.woff) format("woff")}@font-face{font-family:Noto Sans KR;font-style:normal;font-display:swap;font-weight:300;src:local("Noto Sans KR Light "),local("Noto Sans KR-Light"),url(/static/noto-sans-kr-latin-300-4f773a0fce88aa857d70b56c5b0a1d26.woff2) format("woff2"),url(/static/noto-sans-kr-latin-300-ee87751dac814562bac316d848e35748.woff) format("woff")}@font-face{font-family:Noto Sans KR;font-style:normal;font-display:swap;font-weight:400;src:local("Noto Sans KR Regular "),local("Noto Sans KR-Regular"),url(/static/noto-sans-kr-latin-400-be09f2ced7ff9fa6eda5f0416e2fc840.woff2) format("woff2"),url(/static/noto-sans-kr-latin-400-4c50be0fe5b21a153b8e40a392c2d3fe.woff) format("woff")}@font-face{font-family:Noto Sans KR;font-style:normal;font-display:swap;font-weight:500;src:local("Noto Sans KR Medium "),local("Noto Sans KR-Medium"),url(/static/noto-sans-kr-latin-500-416698c2fc4b3951f8d63d3d2ae23900.woff2) format("woff2"),url(/static/noto-sans-kr-latin-500-28601458e118110e494903a1fcd6dcf5.woff) format("woff")}@font-face{font-family:Noto Sans KR;font-style:normal;font-display:swap;font-weight:700;src:local("Noto Sans KR Bold "),local("Noto Sans KR-Bold"),url(/static/noto-sans-kr-latin-700-04e782e08729f3725ae5a9c95da0c8ba.woff2) format("woff2"),url(/static/noto-sans-kr-latin-700-b9e989a96027f839a9569d2d011e0b71.woff) format("woff")}@font-face{font-family:Noto Sans KR;font-style:normal;font-display:swap;font-weight:900;src:local("Noto Sans KR Black "),local("Noto Sans KR-Black"),url(/static/noto-sans-kr-latin-900-c41f1395489a117ca36d550142a1695f.woff2) format("woff2"),url(/static/noto-sans-kr-latin-900-589f5fbf84d9dc9984a969bae969fd60.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:100;src:local("Catamaran Thin "),local("Catamaran-Thin"),url(/static/catamaran-latin-100-3570195a7b5f619dd9b2419d8fa3f089.woff2) format("woff2"),url(/static/catamaran-latin-100-e82908f57f6d2f23eb9876b2d6868195.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:200;src:local("Catamaran Extra Light "),local("Catamaran-Extra Light"),url(/static/catamaran-latin-200-987ea210308405ac77ba2f36430a70c9.woff2) format("woff2"),url(/static/catamaran-latin-200-bb5993d2f001b739bb9ab7c3ed9725c3.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:300;src:local("Catamaran Light "),local("Catamaran-Light"),url(/static/catamaran-latin-300-2b8a4bd13e9d5ba755f010f8732b0bb6.woff2) format("woff2"),url(/static/catamaran-latin-300-c2696c65c33dcf37871b72bad51ee1ce.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:400;src:local("Catamaran Regular "),local("Catamaran-Regular"),url(/static/catamaran-latin-400-640947b787a38ec35d097129637d9130.woff2) format("woff2"),url(/static/catamaran-latin-400-97e5bc807a3e915e3fbf40ce5fcb1128.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:500;src:local("Catamaran Medium "),local("Catamaran-Medium"),url(/static/catamaran-latin-500-884483dd213f37ae3b5c98f73dd190a5.woff2) format("woff2"),url(/static/catamaran-latin-500-412cf386e31213e3601cb2132b9c4c2d.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:600;src:local("Catamaran SemiBold "),local("Catamaran-SemiBold"),url(/static/catamaran-latin-600-eb6ebda25331e50d3f42c45a41f613bb.woff2) format("woff2"),url(/static/catamaran-latin-600-215c58c6114e0556cb1c332c0fda463a.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:700;src:local("Catamaran Bold "),local("Catamaran-Bold"),url(/static/catamaran-latin-700-3196f49881b324fa5a5f937875cc380f.woff2) format("woff2"),url(/static/catamaran-latin-700-05f6e51c518dd3b521b258e5c05d0e72.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:800;src:local("Catamaran ExtraBold "),local("Catamaran-ExtraBold"),url(/static/catamaran-latin-800-601b1d0f1b78fd65c3205b2c004bbe60.woff2) format("woff2"),url(/static/catamaran-latin-800-3b1675e4ede7e86ec79fa84c1203908e.woff) format("woff")}@font-face{font-family:Catamaran;font-style:normal;font-display:swap;font-weight:900;src:local("Catamaran Black "),local("Catamaran-Black"),url(/static/catamaran-latin-900-6bb5f96614acb7754020b922e1a63d24.woff2) format("woff2"),url(/static/catamaran-latin-900-79292dba48851cc3a212863c860d8f09.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.custom-hr{margin:64px 0;background:linear-gradient(72deg,#291e95,#cc007a);border:none;height:2px}.home-header{margin-top:0;border-bottom:none;font-weight:900;font-size:48px;letter-spacing:-2px}.link{box-shadow:none;text-decoration:none;color:inherit}.switch-container{text-align:right}.switch-container .icon{text-align:center;color:#222;font-size:14px;font-weight:900}.footer{padding-top:52px;text-align:center;font-size:12px}.footer a{text-decoration:none!important}.home{position:absolute;margin-top:-1.5px}body.light{background-color:#fff;color:#615f5f}body.light .home-header{color:#5a5a5a}body.light .bio .author-name-content{background-color:#ecf0f2}body.light .bio .author-introduction{color:#7d7d7d}body.light .bio a{color:navy}body.light .bio .bio_fontaswesome{fill:navy;vertical-align:-.125em}body.light .category-container{border-color:#ecf0f2;border-style:solid;border-width:1px 6px;background-color:#f4f7f8}body.light .category-container .item{border:1px solid #ecf0f2;background-color:#fff;box-shadow:0 1px 1px rgba(0,0,0,.1)}body.light .category-container .item a{color:#666}body.light .category-container .item[aria-selected=true]{border:2px solid #909da1;font-weight:bolder}body.light .category-container .item[aria-selected=true] a{color:#636c6e}body.light .category-container .item .badge{background-color:#f5222d;color:#fff}body.light .thumbnail{background-color:#fff;box-shadow:0 0 12px rgba(122,124,136,.212)}body.light .thumbnail h3{color:#5173b3}body.light .thumbnail p{color:#7d7d7d}body.light .thumbnail:hover{text-shadow:.1px .1px .1px rgba(68,67,67,.925);box-shadow:1px 3px 15px rgba(122,124,136,.432)}body.light .footer,body.light .thumbnail .thumbnail-subinfo{color:#615f5f}body.light .footer a{color:#5a5a5a}body.light .navigator a{background-color:#fceff7;color:#cc007a}body.light :not(pre)>code[class*=language-]{color:#fff;border:1.2px solid hsla(0,0%,100%,.6392156862745098);background:#7d7d7d}body.dark{background-color:#282c35;color:#dbd8d8}body.dark .home-header{color:#eee}body.dark .bio .author-name-content{background-color:#383636}body.dark .bio .author-introduction{color:#dbd8d8}body.dark .bio a{color:#bb72ec}body.dark .bio .bio_fontaswesome{fill:#bb72ec;vertical-align:-.125em}body.dark .category-container{border-color:#383636;border-style:solid;border-width:1px 6px;background-color:#24272c}body.dark .category-container .item{border:1px solid #383636;background-color:#282c35;box-shadow:0 1px 1px hsla(0,0%,100%,.1)}body.dark .category-container .item a{color:#d8d7d7}body.dark .category-container .item[aria-selected=true]{border:2px solid #666;font-weight:bolder}body.dark .category-container .item[aria-selected=true] a{color:#fff}body.dark .category-container .item .badge{background-color:#d695ab;color:#eee}body.dark .thumbnail{background-color:#282c35;box-shadow:0 0 12px rgba(197,166,201,.2)}body.dark .thumbnail h3{color:#d695ab}body.dark .thumbnail p{color:#dbd8d8}body.dark .thumbnail:hover{box-shadow:1px 1px 13px rgba(195,153,201,.26);text-shadow:.1px .1px .1px #fff}body.dark .footer,body.dark .thumbnail .thumbnail-subinfo{color:#dbd8d8}body.dark .footer a{color:#fff}body.dark blockquote{border-left:4px solid hsla(0,0%,100%,.822)}body.dark h1,body.dark h2{border-bottom-color:hsla(0,0%,100%,.3)}body.dark .navigator a{background-color:#fceff7;color:#cc007a}body.dark td,body.dark th{border-bottom:1px solid hsla(0,0%,100%,.15)}body.dark :not(pre)>code[class*=language-]{color:#c85656;border:1.2px solid rgba(0,0,0,.6392156862745098);background:#e1e1e1}body.dark hr{background:hsla(0,0%,100%,.3)}body{font-family:Noto Sans KR,sans-serif;background-color:#fff;-webkit-text-size-adjust:antialiased;-moz-osx-font-smoothing:grayscale;transition:background-color .3s,color .3s}h1{margin-top:2em;font-size:2.15em}h1,h2{letter-spacing:-1px;border-bottom:transparent!important}h2{margin-top:1.5em;margin-bottom:0;font-size:1.5em}h3{font-weight:700;margin-bottom:.1rem;margin-top:0;letter-spacing:-1px}@media (max-width:500px){.home-header{font-size:40px}}.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;white-space:normal;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}.post-date{text-align:right;font-size:12px;font-style:italic}.bio{margin-bottom:15px}.bio .author-description{display:flex}.bio .author-image{margin-top:0;margin-right:12px;margin-bottom:0;min-width:95px}.bio .author-name{display:flex;flex-direction:column;justify-content:center}.bio .author-name-prefix{font-size:90%;margin-right:4px}.bio .author-name-content{display:inline-block;font-size:95%;padding:2px 6px;font-weight:bolder;border-radius:8px;transform-origin:center;cursor:default}.bio .author-introduction{margin-top:4px;font-size:80%;line-height:1.4}.bio .author-socials{margin-top:4px}.bio a{margin-right:8px;font-size:80%;cursor:pointer}.bio a.visited{text-decoration:none}@keyframes flutter{0%{transform:rotate(0deg)}35%{transform:rotate(0deg)}40%{transform:rotate(-5deg)}60%{transform:rotate(5deg)}65%{transform:rotate(0deg)}to{transform:rotate(0deg)}}.item{position:relative}.item .badge{display:inline-block;position:absolute;top:1px;right:3px;transform:translate(50%,-50%);border-radius:10px;box-shadow:0 0 0 1px;padding:8px 7px;z-index:999;font-weight:700}.category-container{position:sticky;position:-webkit-sticky;top:0;line-height:0;white-space:nowrap;overflow-x:scroll;-ms-overflow-style:none;overflow:-moz-scrollbars-none;z-index:1;padding:6px 20px;margin:0 -5px!important}.category-container .item{display:inline-block;margin:.25rem 7px .25rem 0;border-radius:15px;white-space:normal;box-sizing:border-box;cursor:pointer}.category-container .item div{display:block;padding:14px 16px 16px;font-size:13px;box-sizing:border-box}.category-container .item:last-child{margin-right:0}.category-container::-webkit-scrollbar{display:none}.thumbnail-container{min-height:calc(100vh - 3.5rem)}.thumbnail{display:block;margin-top:12px;padding:15px 15px 12px;transition:box-shadow .3s,text-shadow .3s,opacity .4s;opacity:0;border-radius:10px}.thumbnail p{font-size:90%;line-height:1.4}.thumbnail .thumbnail-subinfo{font-size:.75rem;margin-bottom:.6rem;padding-bottom:.6rem;border-bottom:1px solid #e8e8e8}.thumbnail.visible{opacity:1}.navigator{margin:40px 0;list-style:none;padding:0;overflow:hidden}.navigator li{margin-bottom:12px}.navigator a{padding:7px 16px 8px;border-radius:6px;font-size:12px;opacity:.8}ul.navigator li.right_navi{float:right}ul.navigator li.left_navi{float:left}.post h1{font-size:2.5rem;line-height:1.1}.post h2{margin-top:3.5rem;font-size:1.73286rem}.post h2,.post p{margin-bottom:1.75rem}.post li{margin-bottom:.875rem}.post .gatsby-highlight-code-line{background-color:#022a4b;display:block;margin-right:-1.2em;margin-left:-1.2em;padding-right:1em;padding-left:.75em;border-left:.35em solid #0687f0}.post blockquote{color:#999}.post code[class*=language-],.post pre[class*=language-]{color:#e0e0e0;background:none;font-family:Fira Code,Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.6;font-size:13px;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;hyphens:none;-ms-overflow-style:none;overflow:-moz-scrollbars-none}.post pre[class*=language-]::-webkit-scrollbar{display:none}.post pre[class*=language-]{padding:1.2em;margin:1.5em 0;overflow:auto;border-radius:.6em}.post :not(pre)>code[class*=language-],.post pre[class*=language-]{background:#212121}.post :not(pre)>code[class*=language-]{padding:.1em .3em;border-radius:.5em;white-space:normal;color:#d66587;margin:0 .1em}.post .token.block-comment,.post .token.cdata,.post .token.comment,.post .token.doctype,.post .token.prolog{color:#616161}.post .token.punctuation{color:#e0e0e0}.post .token.attr-name,.post .token.deleted,.post .token.namespace,.post .token.tag{color:#e2777a}.post .token.function-name{color:#6196cc}.post .token.boolean,.post .token.function,.post .token.number{color:#ff9100}.post .token.class-name,.post .token.constant,.post .token.property,.post .token.symbol{color:#ff0}.post .token.atrule,.post .token.builtin,.post .token.important,.post .token.keyword,.post .token.selector{color:#b388ff}.post .token.attr-value,.post .token.char,.post .token.regex,.post .token.string,.post .token.variable{color:#00e676}.post .token.entity,.post .token.operator,.post .token.url{color:#67cdcc}.post .token.bold,.post .token.important{font-weight:700}.post .token.italic{font-style:italic}.post .token.entity{cursor:help}.post .token.inserted{color:green}.dark .anchor{fill:#dbd8d8}.light .anchor{fill:#615f5f}td[align=center]:first-child,th[align=center]:first-child{text-align:center!important;font-weight:bolder!important}table{margin-top:100px}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;user-select:none;margin:1.2em}.line-numbers-rows>span{display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.tldr{padding-left:1em;margin-top:-26px}h3{margin-bottom:.5em}h3 code.language-text{font-size:16px!important}up{top:-.5em;font-size:75%}down,up{position:relative;line-height:0;vertical-align:baseline;font-weight:500}down{font-size:85%}figcaption{padding:3px;text-align:center}center,figcaption{font:italic smaller sans-serif;font-weight:700;font-size:14px}center{top:-.7em;position:relative}ol li,ol li p{margin-bottom:.3rem!important}.gatsby-resp-image-wrapper{margin-bottom:20px}p{position:relative}a.code_link{position:absolute;font-size:small;bottom:-2rem;left:1rem}a.code_link_2{bottom:-2rem}a.code_link_2,a.code_link_3{position:absolute;font-size:small;left:3.1rem;z-index:999}a.code_link_3{bottom:-2.5rem}a.code_link_4{position:absolute;font-size:small;bottom:-3rem;left:1rem}h4{font-weight:700}a.code_link_5{position:absolute;font-size:small;bottom:-3rem;left:3.1rem;z-index:999}strong{font-weight:700}a.code_link_6{position:absolute;font-size:small;bottom:-2.5rem;z-index:999;left:1rem}summary{display:list-item}a.code_link_7{position:absolute;font-size:small;bottom:-3.5rem;left:1rem}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="icon" href="/favicon-32x32.png?v=f24356c48475809626ea0c2ac67855c6" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#ffffff"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=f24356c48475809626ea0c2ac67855c6"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=f24356c48475809626ea0c2ac67855c6"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=f24356c48475809626ea0c2ac67855c6"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=f24356c48475809626ea0c2ac67855c6"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=f24356c48475809626ea0c2ac67855c6"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=f24356c48475809626ea0c2ac67855c6"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=f24356c48475809626ea0c2ac67855c6"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=f24356c48475809626ea0c2ac67855c6"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><title data-react-helmet="true">React 18 톺아보기 - 02. Lane 모델 | Deep Dive Magic Code</title><meta data-react-helmet="true" name="description" content="Lane은 렌더링에서 동시성을 가져감에 있어 기존의 한계를 해결하기 위해 새롭게 도입된 모델입니다. Lane 이전에는 Expiration Time 모델을 통해서 관리가 되었는데, 해당 모델에 어떠한 한계가 있었는지 먼저 짚어보고 Lane 모델로 넘어가겠습니다. Expiration Time의 정의는 이전 포스터에서 확인하세요. Expiration Time Expiration Time의 우선순위에는 상수인 Sync, Idle, Batched…"/><meta data-react-helmet="true" property="og:title" content="React 18 톺아보기 - 02. Lane 모델 | Deep Dive Magic Code"/><meta data-react-helmet="true" property="og:description" content="Lane은 렌더링에서 동시성을 가져감에 있어 기존의 한계를 해결하기 위해 새롭게 도입된 모델입니다. Lane 이전에는 Expiration Time 모델을 통해서 관리가 되었는데, 해당 모델에 어떠한 한계가 있었는지 먼저 짚어보고 Lane 모델로 넘어가겠습니다. Expiration Time의 정의는 이전 포스터에서 확인하세요. Expiration Time Expiration Time의 우선순위에는 상수인 Sync, Idle, Batched…"/><meta data-react-helmet="true" property="og:image" content="/static/felog-f24356c48475809626ea0c2ac67855c6.png"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="google-site-verification" content="o402P1kCwteUVT_5s9zR21dD9lTF4ALZNLms22CIMx4"/><meta data-react-helmet="true" name="keywords" content="react, redux, javascript, web, development, frontend, 리액트, 리덕스, 리액트18, 리액트 18, react 18, react18, transition lane, concurrent render, 리액트, react, react 18, concurrent render, lane, lane model"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-bc5c486950fc7f0073c7.js"/><link as="script" rel="preload" href="/framework-8de36d3fd07627b19105.js"/><link as="script" rel="preload" href="/app-fe38415449496a7ca990.js"/><link as="script" rel="preload" href="/styles-0ec71dd62c66cb95665c.js"/><link as="script" rel="preload" href="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-37f4b6ff0ea9acd778e4.js"/><link as="script" rel="preload" href="/cd7d5f864fc9e15ed8adef086269b0aeff617554-6020d22b933a677a17bf.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-e199dfe7aaf4d1d814d2.js"/><link as="fetch" rel="preload" href="/page-data/react/in-depth-react18-lane/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2277278352.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/536400264.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:52rem;padding:2.4375rem 1.21875rem" class="post"><a class="link" href="/"><svg class="home" width="1.125em" font-size="2em" overflow="visible" viewBox="0 0 576 512"><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg></a><div class="switch-container"><label for="normal-switch"><div style="position:relative;display:inline-block;text-align:left;opacity:1;direction:ltr;border-radius:12px;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s;touch-action:none;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none"><div class="react-switch-bg" style="height:24px;width:48px;margin:0;position:relative;background:#d9dfe2;border-radius:12px;cursor:pointer;-webkit-transition:background 0.25s;-moz-transition:background 0.25s;transition:background 0.25s"><div style="height:24px;width:26px;position:relative;opacity:0;pointer-events:none;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s"><div class="icon checkedIcon">D</div></div><div style="height:24px;width:26px;position:absolute;opacity:1;right:0;top:0;pointer-events:none;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s"><div class="icon uncheckedIcon">L</div></div></div><div class="react-switch-handle" style="height:22px;width:22px;background:#ffffff;display:inline-block;cursor:pointer;border-radius:50%;position:absolute;transform:translateX(1px);top:1px;outline:0;border:0;-webkit-transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s;-moz-transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s;transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s"></div><input type="checkbox" role="switch" style="border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px" id="normal-switch"/></div></label></div><h1>React 18 톺아보기 - 02. Lane 모델</h1><div style="display:flex;justify-content:space-between"><div style="display:flex;gap:3px"><svg viewBox="0 0 30 30" width="25px" height="25px"><g id="cc-logo"><path d="M14.972 0c4.196 0 7.769 1.465 10.715 4.393A14.426 14.426 0 0128.9 9.228C29.633 11.04 30 12.964 30 15c0 2.054-.363 3.978-1.085 5.772a13.77 13.77 0 01-3.2 4.754 15.417 15.417 0 01-4.983 3.322A14.932 14.932 0 0114.973 30c-1.982 0-3.88-.38-5.692-1.14a15.087 15.087 0 01-4.875-3.293c-1.437-1.437-2.531-3.058-3.281-4.862A14.71 14.71 0 010 15c0-1.982.38-3.888 1.138-5.719a15.062 15.062 0 013.308-4.915C7.303 1.456 10.812 0 14.972 0zm.055 2.706c-3.429 0-6.313 1.196-8.652 3.589a12.896 12.896 0 00-2.72 4.031 11.814 11.814 0 00-.95 4.675c0 1.607.316 3.156.95 4.646a12.428 12.428 0 002.72 3.992 12.362 12.362 0 003.99 2.679c1.483.616 3.037.924 4.662.924 1.607 0 3.164-.312 4.675-.937a12.954 12.954 0 004.084-2.705c2.339-2.286 3.508-5.152 3.508-8.6 0-1.66-.304-3.231-.91-4.713a11.994 11.994 0 00-2.651-3.965c-2.412-2.41-5.314-3.616-8.706-3.616zm-.188 9.803l-2.01 1.045c-.215-.445-.477-.758-.79-.937-.312-.178-.602-.268-.87-.268-1.34 0-2.01.884-2.01 2.652 0 .803.17 1.446.509 1.928.34.482.84.724 1.5.724.876 0 1.492-.43 1.85-1.286l1.847.937a4.407 4.407 0 01-1.634 1.728c-.696.42-1.464.63-2.303.63-1.34 0-2.42-.41-3.242-1.233-.821-.82-1.232-1.964-1.232-3.428 0-1.428.416-2.562 1.246-3.401.83-.84 1.879-1.26 3.147-1.26 1.858 0 3.188.723 3.992 2.17zm8.652 0l-1.983 1.045c-.214-.445-.478-.758-.79-.937-.313-.178-.613-.268-.897-.268-1.34 0-2.01.884-2.01 2.652 0 .803.17 1.446.51 1.928.338.482.838.724 1.5.724.874 0 1.49-.43 1.847-1.286l1.875.937a4.606 4.606 0 01-1.66 1.728c-.696.42-1.455.63-2.277.63-1.357 0-2.441-.41-3.253-1.233-.814-.82-1.22-1.964-1.22-3.428 0-1.428.415-2.562 1.246-3.401.83-.84 1.879-1.26 3.147-1.26 1.857 0 3.18.723 3.965 2.17z" fill="currentColor"></path></g></svg><svg viewBox="0 0 30 30" width="25px" height="25px"><g id="cc-by"><path d="M14.973 0c4.213 0 7.768 1.446 10.66 4.34C28.544 7.25 30 10.803 30 15c0 4.215-1.43 7.723-4.287 10.526C22.678 28.51 19.098 30 14.973 30c-4.054 0-7.571-1.474-10.553-4.42C1.474 22.633 0 19.107 0 15S1.474 7.34 4.42 4.34C7.313 1.446 10.83 0 14.973 0zm.054 2.706c-3.41 0-6.295 1.196-8.652 3.589-2.447 2.5-3.67 5.402-3.67 8.706 0 3.321 1.214 6.196 3.642 8.624 2.429 2.429 5.322 3.642 8.679 3.642 3.339 0 6.25-1.222 8.732-3.67 2.358-2.267 3.536-5.133 3.536-8.598 0-3.41-1.197-6.311-3.589-8.705-2.392-2.392-5.285-3.588-8.678-3.588zm4.018 8.57v6.134H17.33v7.286h-4.66V17.41h-1.714v-6.134a.93.93 0 01.28-.683.933.933 0 01.684-.281h6.161c.25 0 .474.093.67.28a.912.912 0 01.294.684zM12.91 7.42c0-1.41.696-2.116 2.09-2.116s2.09.705 2.09 2.116c0 1.393-.697 2.09-2.09 2.09-1.393 0-2.09-.697-2.09-2.09z" fill="currentColor"></path></g></svg><svg viewBox="0 0 30 30" width="25px" height="25px"><g id="cc-nc"><path d="M14.973 0c4.214 0 7.768 1.446 10.66 4.339C28.544 7.232 30 10.786 30 15c0 4.215-1.429 7.723-4.287 10.527C22.678 28.51 19.097 30 14.973 30c-4.072 0-7.59-1.482-10.553-4.446C1.474 22.607 0 19.09 0 15c0-4.107 1.474-7.66 4.42-10.66C7.313 1.446 10.83 0 14.973 0zM3.375 10.956c-.446 1.232-.67 2.58-.67 4.045 0 3.321 1.214 6.196 3.642 8.624 2.447 2.412 5.34 3.617 8.679 3.617 3.375 0 6.285-1.223 8.733-3.67.875-.839 1.561-1.714 2.061-2.626l-5.651-2.518a3.866 3.866 0 01-1.433 2.317c-.76.598-1.657.943-2.693 1.031v2.304h-1.74v-2.304c-1.661-.017-3.18-.615-4.554-1.794l2.063-2.089c.981.91 2.098 1.366 3.348 1.366.517 0 .96-.116 1.326-.349.366-.231.55-.615.55-1.151 0-.376-.135-.68-.402-.911l-1.447-.617-1.767-.804-2.384-1.044-7.661-3.427zm11.652-8.278c-3.41 0-6.295 1.206-8.652 3.616-.59.59-1.143 1.26-1.66 2.01l5.732 2.571a3.513 3.513 0 011.42-1.888c.695-.473 1.508-.737 2.437-.79V5.893h1.741v2.304c1.376.071 2.625.535 3.75 1.392L17.84 11.6c-.84-.59-1.697-.884-2.572-.884-.464 0-.88.09-1.245.267-.366.179-.55.483-.55.911 0 .125.045.25.134.375l1.902.858 1.313.59 2.41 1.07 7.687 3.429c.25-1.054.375-2.125.375-3.214 0-3.447-1.196-6.349-3.588-8.707-2.375-2.41-5.27-3.616-8.68-3.616z" fill="currentColor"></path></g></svg><svg viewBox="0 0 30 30" width="25px" height="25px"><g id="cc-nd"><path d="M14.973 0c4.196 0 7.75 1.455 10.66 4.366C28.544 7.26 30 10.804 30 15c0 4.197-1.43 7.714-4.287 10.553C22.696 28.518 19.115 30 14.973 30c-4.054 0-7.571-1.473-10.553-4.42C1.474 22.634 0 19.108 0 15c0-4.088 1.474-7.633 4.42-10.633C7.33 1.455 10.848 0 14.973 0zm.054 2.706c-3.41 0-6.295 1.205-8.652 3.616-2.447 2.483-3.67 5.375-3.67 8.678 0 3.34 1.214 6.214 3.642 8.625 2.429 2.43 5.322 3.643 8.679 3.643 3.339 0 6.25-1.223 8.732-3.67 2.358-2.285 3.536-5.15 3.536-8.598 0-3.428-1.197-6.321-3.589-8.678-2.375-2.412-5.268-3.616-8.678-3.616zm5.652 8.758v2.571H9.777v-2.571H20.68zm0 4.822v2.57H9.777v-2.57H20.68z" fill="currentColor"></path></g></svg></div><p class="post-date">a year ago</p></div><div><p>Lane은 렌더링에서 동시성을 가져감에 있어 기존의 한계를 해결하기 위해 새롭게 도입된 모델입니다. Lane 이전에는 Expiration Time<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> 모델을 통해서 관리가 되었는데, 해당 모델에 어떠한 한계가 있었는지 먼저 짚어보고 Lane 모델로 넘어가겠습니다.</p>
<h1 id="expiration-time" style="position:relative;"><a href="#expiration-time" aria-label="expiration time permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Expiration Time</h1>
<p>Expiration Time의 우선순위에는 상수인 Sync, Idle, Batched와 중요도에 따라 계산된 값이 있습니다. 숫자가 클수록 우선순위가 높으며, Sync 또는 만료된 Expiration Time이 가장 우선순위가 높습니다. 그래서 Sync는 부호 있는 31 비트에서 가장 큰 수를 사용합니다(<a href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/MaxInts.js#L13">참고</a>).</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v16.12.0/packages/react-reconciler/src/ReactFiberExpirationTime.js#L23-L40">reconciler > ReactFiberExpirationTime.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">const</span> NoWork <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">const</span> Never <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">const</span> Idle <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">const</span> Sync <span class="token operator">=</span> <span class="token constant">MAX_SIGNED_31_BIT_INT</span>
<span class="token keyword">const</span> Batched <span class="token operator">=</span> Sync <span class="token operator">-</span> <span class="token number">1</span></code></pre></div>
<p>우선순위를 기반으로 Expiration Time을 계산하는 방법은 렌더링 모드에 따라 다음과 같이 결정됩니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v16.12.0/packages/react-reconciler/src/ReactFiberWorkLoop.js#L310">reconciler > ReactFiberWorkLoop.js > computeExpirationForFiber()</a></p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">computeExpirationForFiber</span><span class="token punctuation">(</span><span class="token parameter">currentTime<span class="token punctuation">,</span> fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mode <span class="token operator">=</span> fiber<span class="token punctuation">.</span>mode<span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">(</span>mode <span class="token operator">&amp;</span> BlockingMode<span class="token punctuation">)</span> <span class="token operator">===</span> NoMode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">   <span class="token keyword">return</span> Sync<span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span>
  <span class="token keyword">const</span> priorityLevel <span class="token operator">=</span> <span class="token function">getCurrentPriorityLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 스케줄러에서 이벤트의 우선순위를 참조한다.</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mode <span class="token operator">&amp;</span> ConcurrentMode<span class="token punctuation">)</span> <span class="token operator">===</span> NoMode<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">return</span> priorityLevel <span class="token operator">===</span> ImmediatePriority <span class="token operator">?</span> Sync <span class="token operator">:</span> Batched<span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span><span class="gatsby-highlight-code-line"></span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token parameter">priorityLevel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">case</span> ImmediatePriority<span class="token operator">:</span>
    expirationTime <span class="token operator">=</span> Sync<span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
   <span class="token keyword">case</span> UserBlockingPriority<span class="token operator">:</span>
    expirationTime <span class="token operator">=</span> <span class="token function">computeInteractiveExpiration</span><span class="token punctuation">(</span>currentTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
   <span class="token keyword">case</span> NormalPriority<span class="token operator">:</span>
   <span class="token keyword">case</span> LowPriority<span class="token operator">:</span>
    expirationTime <span class="token operator">=</span> <span class="token function">computeAsyncExpiration</span><span class="token punctuation">(</span>currentTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
   <span class="token keyword">case</span> IdlePriority<span class="token operator">:</span>
    expirationTime <span class="token operator">=</span> Idle<span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
   <span class="token keyword">default</span><span class="token operator">:</span>
    <span class="token function">invariant</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'Expected a valid priority level'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p>리액트 17의 <a target="blank" href="https://17.reactjs.org/docs/concurrent-mode-adoption.html#feature-comparison">Adopting Concurrent Mode</a> 문서를 참고하면 모드에는 Legacy Mode, Blocking Mode, Concurrent Mode<sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>가 있으며, 코드를 보면 아시겠지만, 정식 버전으로는 switch문에 도달할 수 없습니다. 우선순위 기반 렌더링이나 동시성 렌더링 기능을 사용하기 위해서는 실험적 버전을 통해 리액트를 설치해야 합니다.</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token function">npm</span> <span class="token function">install</span> react@experimental react-dom@experimental</code></pre></div>
<p>아무튼 대부분의 개발자는 의도적이든 아니든 LagacyMode(ReactDOM.render)를 사용하고 있었고 모든 업데이트가 Sync의 우선순위를 가졌습니다.</p>
</blockquote>
<p>마지막으로 Expiration Time에서는 렌더링 대상의 우선순위를 기준으로 같거나 큰 업데이트만 렌더링 대상에 포함되어 배치처리 됩니다. 다음은 렌더링 과정에서 현재 위치의 서브 트리가 렌더링 대상에 포함되는지 확인하는 코드입니다.</p>
<p><a class="code_link_2" target="blink" href="https://github.com/facebook/react/blob/v16.12.0/packages/react-reconciler/src/ReactFiberBeginWork.js#L2732-L2742">reconciler > ReactFiberBeginWork.js > bailoutOnAlreadyFinishedWork()</a></p>
<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber 0" class="language-js line-numbers"><code class="language-js">‎
<span class="token keyword">const</span> childExpirationTime <span class="token operator">=</span> workInProgress<span class="token punctuation">.</span>childExpirationTime
<span class="token keyword">if</span> <span class="token punctuation">(</span>childExpirationTime <span class="token operator">&lt;</span> renderExpirationTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token function">cloneChildFibers</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> workInProgress<span class="token punctuation">)</span>
  <span class="token keyword">return</span> workInProgress<span class="token punctuation">.</span>child
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>서브 트리의 우선순위(childExpirationTime)가 현재 렌더링 중인 우선순위(renderExpirationTime) 보다 낮다면<sup>3</sup> null를 반환<sup>4</sup>하여 하위 트리로 렌더링 작업이 진행되지 않도록 합니다.</p>
<h1 id="lane-모델이-해결하고자-하는-것" style="position:relative;"><a href="#lane-%EB%AA%A8%EB%8D%B8%EC%9D%B4-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B3%A0%EC%9E%90-%ED%95%98%EB%8A%94-%EA%B2%83" aria-label="lane 모델이 해결하고자 하는 것 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lane 모델이 해결하고자 하는 것</h1>
<h2 id="업데이트-개념-분리" style="position:relative;"><a href="#%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EA%B0%9C%EB%85%90-%EB%B6%84%EB%A6%AC" aria-label="업데이트 개념 분리 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>업데이트 개념 분리</h2>
<p>Expiration Time은 두 가지 개념이 하나의 시간 데이터에 존재했습니다.</p>
<ul>
<li>우선순위: 업데이트를 발생시킨 이벤트를 기준으로 우선순위를 결정하고 업데이트 간 우선순위는 대소 비교를 통해 판단</li>
<li>배치 여부: 업데이트의 배치 여부는 값의 대소비교를 통해 판단</li>
</ul>
<p>이런 구현사항은 상위 우선순위를 가진 업데이트를 먼저 처리하도록 설계되어 있어 문제없이 잘 동작하고 있었습니다.</p>
<blockquote>
<p>A > B > C의 우선순위가 주어지면 A에 대한 작업 완료 없이는 B에 대한 작업을 수행할 수 없습니다. 마찬가지로 A와 B를 모두 완료하지 않고 C로 넘어갈 수 없습니다.</p>
</blockquote>
<p>이는 Suspense가 나오기 이전에 설계되었으며, 우선순위가 아닌 다른 이유로 작업의 순서를 결정해야 할 이유가 없었습니다. 하지만 Suspense와 함께 렌더링에 IO-Bound라는 개념이 추가되면서 이야기가 달라졌습니다. CPU - IO - CPU의 순서로 렌더링 작업이 진행될 경우, 우선순위가 높은 IO-Bound 렌더링이 상대적으로 우선순위가 낮은 두 번째 CPU-Bound 렌더링 작업을 차단하는 경우가 발생하게 되었습니다.</p>
<p>전환을 예로 들면 네트워크 요청이 필요한 전환도 있고 아닌 전환도 있을 것입니다. 가령 화면을 전환 시키는 A, B 버튼이 있고 A 버튼은 로컬 데이터를, B 버튼은 네트워크 데이터를 사용하여 여러 UI가 전환된다고 해봅시다. 사용자도 버튼별 차이점을 알고 있다고 했을 때 네트워크 요청이 필요한 B 버튼의 전환을 사용자도 즉각적으로 반응할 것이라고 기대하지 않습니다. 그리고 상대적으로 IO-Bound는 CPU-Bound보다 느릴 수 밖에 없습니다. 그렇기 때문에 같은 우선순위를 가진 전환 렌더링이라도 IO-Bound 보다는 CPU-Bound를 먼저 처리하는 게 유리합니다.</p>
<blockquote>
<p>정확히 어떠한 상황의 렌더링이 IO-Bound인지 <a href="/react/in-depth-react18-transition_2#1-업데이트의-개념-분리" target="_">Transition Lane</a> 글에서 자세히 다룹니다.</p>
</blockquote>
<p>Expiration Time은 이벤트 우선순위와 업데이트 발생 시점을 기준으로 시간 데이터를 계산하여 사용합니다. 짧은 간격으로 B - A의 버튼이 클릭 된 경우, 같은 전환 우선순위를 기반으로 Expiration Time이 계산될 것입니다. 여기서 IO - CPU의 시간 범위를 지정하고 구분할 수 있어야 하는데, 다음과 같이 범위를 나타낼 수는 있지만, 해당 범위에서 특정 범위(일련의 범위에서 IO-Bound에 해당하는 Expiration Time)를 제거할 수는 없습니다.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> isTaskIncludedInBatch <span class="token operator">=</span>
  taskPriority <span class="token operator">&lt;=</span> highestPriorityInRange <span class="token operator">&amp;&amp;</span>
  taskPriority <span class="token operator">>=</span> lowestPriorityInRange</code></pre></div>
<p>리액트 18의 렌더링은 여러 요소(업데이트 종류, Suspense, Hydrate)에 따라서 렌더링 방식을 다르게 가져갑니다. 여기에 맞춰서 업데이트를 보다 세부적으로 관리할 수 있어야 합니다.</p>
<p>이를 위해 Lane은 두 가지 개념(업데이트 간의 우선순위, 업데이트 배치 여부)을 분리하여 관리할 수 있도록 구상되었습니다.</p>
<h2 id="우선순위가-더-높은-업데이트를-먼저-처리하기" style="position:relative;"><a href="#%EC%9A%B0%EC%84%A0%EC%88%9C%EC%9C%84%EA%B0%80-%EB%8D%94-%EB%86%92%EC%9D%80-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8%EB%A5%BC-%EB%A8%BC%EC%A0%80-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0" aria-label="우선순위가 더 높은 업데이트를 먼저 처리하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>우선순위가 더 높은 업데이트를 먼저 처리하기</h2>
<p>같은 상태의 변경이라도 우선순위가 다를 수 있습니다. 사용자 액션으로부터 text 상태를 변경하는 것과 startTransition API를 사용하여 text 상태를 변경하는 것처럼 말이죠. 사용자 액션의 응답이 가장 중요하므로 렌더링 중이라도 우선순위가 더 높은 업데이트가 발생한다면 현재의 렌더링을 중단하고 우선순위가 더 높은 업데이트를 기준으로 다시 렌더링을 진행할 수 있어야 합니다. 이 과정에서 여러 업데이트 중에 발생 시점과 상관없이 적절히 우선순위를 판별하고 처리할 수도 있어야 합니다.</p>
<p>Lane은 시간에 의존적이지 않습니다. 렌더링 순서가 변경되어도 여러 업데이트를 기준에 따라 정확하게 구분할 수 있습니다.</p>
<h2 id="불필요한-렌더링-건너뛰기" style="position:relative;"><a href="#%EB%B6%88%ED%95%84%EC%9A%94%ED%95%9C-%EB%A0%8C%EB%8D%94%EB%A7%81-%EA%B1%B4%EB%84%88%EB%9B%B0%EA%B8%B0" aria-label="불필요한 렌더링 건너뛰기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>불필요한 렌더링 건너뛰기</h2>
<p>업데이트 종류에 따라 렌더링 방식이 다르다고 했습니다. 즉각적인 반응을 위해 업데이트 발생과 동시에 렌더링으로 이어지는 업데이트가 있고 적절히 배치 처리하는 업데이트도 있습니다. 여기서 화면 전환은 우선순위가 가장 낮지만, 렌더링에 필요한 리소스는 반대로 큽니다. 사용자의 텍스트 입력에 반응하는 것과 텍스트로부터 자동 완성 UI를 렌더링하는 것의 차이점입니다. 이런 이유로 전환의 렌더링 방식은 Time Slicing(추후 언급될 Concurrent Render의 구현 방식) 기법을 통해 잘게 쪼개 점진적으로 렌더링을 이어 갑니다. 이 때문에 렌더링 완료까지 상대적으로 다른 업데이트보다 오래걸립니다. 하지만 전환은 우선순위가 낮고 리소스가 많이 들기 때문에 앱의 높은 응답성을 위한 선택 중 하나입니다.</p>
<blockquote>
<p>자세한 전환의 렌더링 방식은 Concurrent Render 글에서 자세히 다룹니다.</p>
</blockquote>
<p>전환 렌더링 기준으로 A0 UI에 대한 렌더링이 진행되는 와중에 상태 변경에 따라 A1, A2의 전환이 발생할 수도 있습니다. 최종 상태의 전환 UI는 A2이기 때문에 이전 상태의 A0, A1의 렌더링은 더 이상 진행할 필요가 없으며 리소스 낭비입니다. 사용자는 중간 상태의 UI보다는 이미 최종 상태의 UI를 기대하고 있기 때문입니다. 이런 중간 상태의 불필요한 렌더링을 건너뛸 수 있어야 합니다.</p>
<p>리액트 18에서는 Lane을 통해 오래된 렌더링을 폐기, 중간 상태를 건너뛰고 최신 상태의 렌더링을 다시 수행할 수 있습니다.</p>
<p>위 내용은 이번 시리즈 전반에 걸쳐 확인하게 됩니다.</p>
<h1 id="lane" style="position:relative;"><a href="#lane" aria-label="lane permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lane</h1>
<p>Lane은 리액트 내부에서도 단어 그대로 차선의 개념으로 이해할 수 있습니다. Lane의 종류는 다음과 같습니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberLane.new.js#L34-L71">reconciler > ReactFiberLane.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token comment">// Lane 중 설명에 필요한 부분만 간추렸습니다.</span>
<span class="token keyword">const</span> <span class="token literal-property property">NoLanes</span><span class="token operator">:</span> Lanes <span class="token operator">=</span> <span class="token comment">/*                        */</span> <span class="token number">0b0000000000000000000000000000000</span>
<span class="token keyword">const</span> <span class="token literal-property property">NoLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*                          */</span> <span class="token number">0b0000000000000000000000000000000</span>

<span class="token keyword">const</span> <span class="token literal-property property">SyncLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*                        */</span> <span class="token number">0b0000000000000000000000000000010</span>

<span class="token keyword">const</span> <span class="token literal-property property">InputContinuousLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*             */</span> <span class="token number">0b0000000000000000000000000001000</span>

<span class="token keyword">const</span> <span class="token literal-property property">DefaultLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*                     */</span> <span class="token number">0b0000000000000000000000000100000</span>

<span class="token keyword">const</span> <span class="token literal-property property">SyncUpdateLanes</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*                */</span> <span class="token number">0b0000000000000000000000000101010</span>

<span class="token keyword">const</span> <span class="token literal-property property">TransitionLanes</span><span class="token operator">:</span> Lanes <span class="token operator">=</span> <span class="token comment">/*                       */</span> <span class="token number">0b0000000011111111111111110000000</span>
<span class="token keyword">const</span> <span class="token literal-property property">TransitionLane1</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*                        */</span> <span class="token number">0b0000000000000000000000010000000</span>
<span class="token comment">/*...*/</span>
<span class="token keyword">const</span> <span class="token literal-property property">TransitionLane16</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*                       */</span> <span class="token number">0b0000000010000000000000000000000</span>

<span class="token keyword">const</span> <span class="token literal-property property">RetryLanes</span><span class="token operator">:</span> Lanes <span class="token operator">=</span> <span class="token comment">/*                            */</span> <span class="token number">0b0000111100000000000000000000000</span>
<span class="token keyword">const</span> <span class="token literal-property property">RetryLane1</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*                             */</span> <span class="token number">0b0000000100000000000000000000000</span>
<span class="token comment">/*...*/</span>
<span class="token keyword">const</span> <span class="token literal-property property">RetryLane4</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token comment">/*                             */</span> <span class="token number">0b0000100000000000000000000000000</span></code></pre></div>
<p>리액트는 Lane의 자료 구조로 비트 마스크 채용했습니다. 비트 마스크의 기본 개념은 <a href="/react/in-depth-react-intro/#bit-masking" target="blank">React 톺아보기 - 02.Intro</a>에서 확인했습니다. 이때는 현재의 컨텍스트가 무엇인지 확인하는 데에만 썼다면 지금은 비트별 우선순위와 그룹과 관련한 연산이 추가로 필요합니다. 다만, 이번 주제를 이해하는데 필수 요소는 아니기 때문에 흥미가 있으신 분은 확인하고 넘어가세요.</p>
<details><summary>신규 비트 연산</summary><blockquote>
  <h4>가장 우선순위가 높은 Lane 선택</h4>
Lane은 우측에 가까운 비트일수록 우선순위가 높습니다. Lane이 그룹 지어 있는 경우, 가장 우측의 Lane이 가장 우선순위가 높은 Lane입니다. 가장 우측의 비트를 선택하는 방법은 음수로 변경한 후 & 연산을 하면 됩니다.
<blockquote>
<p>7: 0111<br>
&#x26;<br>
-7: 0111 -> 1000 + 1 -> 1001</p>
<p>4: 0100<br>
&#x26;<br>
-4: 0100 -> 1011 + 1 -> 1100</p>
</blockquote>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getHighestPriorityLane</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">lanes</span><span class="token operator">:</span> Lanes</span><span class="token punctuation">)</span><span class="token operator">:</span> Lane <span class="token punctuation">{</span>
  <span class="token keyword">return</span> lanes <span class="token operator">&amp;</span> <span class="token operator">-</span>lanes
<span class="token punctuation">}</span></code></pre></div>
  <h4>비트를 인덱스로 다루기</h4>
   인덱스를 Lane으로 변환하는 방법은 시프트 연산자를 사용합니다.
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> index</code></pre></div>
<p>반대로 특정 비트의 인덱스를 얻기 위해서는 Math.clz32()를 사용합니다. 32비트에서 좌측의 0의 개수를 바탕으로 가장 좌측에 위치한 비트의 인덱스를 선택합니다.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 00000000000000000000000000000100</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">clz32</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// output: 29</span>

<span class="token comment">// 0의 갯수에서 -31를 빼면 가장 좌측에 있는 lane의 인덱스를 구할 수 있다.</span>
<span class="token keyword">function</span> <span class="token function">pickArbitraryLaneIndex</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">lanes</span><span class="token operator">:</span> Lanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">31</span> <span class="token operator">-</span> <span class="token function">clz32</span><span class="token punctuation">(</span>lanes<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<h4>비트 병합하기</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">mergeLanes</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">a</span><span class="token operator">:</span> Lanes <span class="token operator">|</span> Lane<span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> Lanes <span class="token operator">|</span> Lane</span><span class="token punctuation">)</span><span class="token operator">:</span> Lanes <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">|</span> b
<span class="token punctuation">}</span></code></pre></div>
<h4>A 그룹이 B 그룹에 포함되는지 확인하기</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">isSubsetOfLanes</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">set</span><span class="token operator">:</span> Lanes<span class="token punctuation">,</span> <span class="token literal-property property">subset</span><span class="token operator">:</span> Lanes <span class="token operator">|</span> Lane</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>set <span class="token operator">&amp;</span> subset<span class="token punctuation">)</span> <span class="token operator">===</span> subset
<span class="token punctuation">}</span></code></pre></div>
<h4>두 비트의 우선순위 비교하기</h4>
a 비트가 b 비트 보다 우선순위가 더 높은지 확인하기
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">isHigherEventPriority</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">a</span><span class="token operator">:</span> EventPriority<span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> EventPriority</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">&lt;</span> b
<span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p>0은 NoLane으로 값이 없음을 의미합니다.</p>
</blockquote>
<p>a, b 중 우선순위가 더 높거나, 낮은 비트 선택하기</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">higherEventPriority</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">a</span><span class="token operator">:</span> EventPriority<span class="token punctuation">,</span>
  <span class="token literal-property property">b</span><span class="token operator">:</span> EventPriority</span>
<span class="token punctuation">)</span><span class="token operator">:</span> EventPriority <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">&lt;</span> b <span class="token operator">?</span> a <span class="token operator">:</span> b
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">lowerEventPriority</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">a</span><span class="token operator">:</span> EventPriority<span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> EventPriority</span><span class="token punctuation">)</span><span class="token operator">:</span> EventPriority <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">||</span> a <span class="token operator">></span> b <span class="token operator">?</span> a <span class="token operator">:</span> b
<span class="token punctuation">}</span></code></pre></div>
<h4>Lane을 이벤트 우선순위로 변환하기</h4>
<p>위 비트 연산들은 다음과 같이 사용됩니다.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">lanesToEventPriority</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">lanes</span><span class="token operator">:</span> Lanes</span><span class="token punctuation">)</span><span class="token operator">:</span> EventPriority <span class="token punctuation">{</span>
  <span class="token keyword">const</span> lane <span class="token operator">=</span> <span class="token function">getHighestPriorityLane</span><span class="token punctuation">(</span>lanes<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isHigherEventPriority</span><span class="token punctuation">(</span>DiscreteEventPriority<span class="token punctuation">,</span> lane<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> DiscreteEventPriority
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isHigherEventPriority</span><span class="token punctuation">(</span>ContinuousEventPriority<span class="token punctuation">,</span> lane<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ContinuousEventPriority
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">includesNonIdleWork</span><span class="token punctuation">(</span>lane<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> DefaultEventPriority
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> IdleEventPriority
<span class="token punctuation">}</span></code></pre></div>
</blockquote></details>
<h1 id="업데이트와-lane" style="position:relative;"><a href="#%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8%EC%99%80-lane" aria-label="업데이트와 lane permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>업데이트와 Lane</h1>
<p>리액트에서 업데이트가 발생하면 해당 업데이트의 종류에 따라서 Lane을 할당합니다. 업데이트는 다음과 같이 차선 위에 올라가 있는 형태가 됩니다.</p>
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 790px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 84.84848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAADYklEQVQ4y3WUyW8bZRiH51+rbMqlaet4mX28xlscr0lQ68Rx4pJ940CiQKgTt4K6AZUuQBKHQBV6qARXhCgHDkhICCpxBvHwzrQNIZjDb95vGT16108xNA2zjwxVxdA1tEiEVDLBaK1KrVrFMAw0udd1va+UoHwuWRYDZ3TFcQjF4mi6Q9CKYkaTxJJZEpkMpgDVl8B+YKUZjfJAftqTzYci134QUenYEZZmkmyndVZrNuuNFI1YDFNkmeYp7DxUed8y4aKPP1/z8ddFP/gvgM/P78brHDzK8uNYgKdrBl93M9yMifeaTjIe/w/s1VrRVAs9kkANx4mITDVJLjOKY6ZRgw5aUDwK20QHLcmrhSq5jYmX/XLp7pW5SZOT7mV6uwMcdQY4FHvYucrx7csc3xrg81uX2HjXYms3SatuEhjUcGzLg3qQc54q20sGf3zj5+djH798KaE+8fH8xM/zr/z8JvbXxxfYP9B4/CTOxoLJlYB0gCFQKVxcQh9KpcgMDf3joeu6LZeGZeNIZYvlEoVi8VS2E8XWHBzR2TDdShuaSqUxzXCjRUwYphRLKeXHaNbeol5aYrK8zERFVJZ1ZYWp6qqcLzP/dpn1do3icJVwOHQanio9aiVSVJstdtptqtKnSjE/ysyYC1wQ0CINAU7VVmlUl719vbTI3HqFtXfGKeb/DXQ9DgWDVEpFDg8P2djYkJBNN2RLZGJZBolknFJ5hFw+6525MqTyhpoWwIv+06R13Gq761AoRC6X4+ioR7fblcZe3OTOyU/sHHxHp/e9Z9uffSvrZ3SOnrHb+4H39te5/cUKE7MrBANXPbBbZbcork2n04yPj1MoFFCq16ZZ291nbnOPha2PWNv5lNX2I1ZuPmR5+z7zW/eY3Wyw0m5ReWOS4GDAA0VlwtyQzZdTE5TQw+EwiiktEHd0opbqqVjISPLTlIs5hnMp78w2bWzDkZF70RrxM5PySi7c68MbMzV6D+f5uDvNg72W2Cb37kyLprh/V87uzrDXG+WTp9e50SpLzjSS8vq4OTw/JR5wpJBmtlVh4nqeiWt5WVeZf3NMbI2piREa9WHqzTQz83nKpayEKqMoL9L/PWGKLgk2TAnHlpdEbDKVkQqPkBrKemeWPF+WJXd61Gvys7B+0L8BnLsKFhZqLRQAAAAASUVORK5CYII='); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="lanes" title="lanes" src="/static/8d9db7f338c27a49c96dff40a2dcaf74/2e237/lanes.png" srcset="/static/8d9db7f338c27a49c96dff40a2dcaf74/18f77/lanes.png 198w,
/static/8d9db7f338c27a49c96dff40a2dcaf74/2cb6c/lanes.png 395w,
/static/8d9db7f338c27a49c96dff40a2dcaf74/2e237/lanes.png 790w,
/static/8d9db7f338c27a49c96dff40a2dcaf74/471ef/lanes.png 1185w,
/static/8d9db7f338c27a49c96dff40a2dcaf74/5d6a0/lanes.png 1580w,
/static/8d9db7f338c27a49c96dff40a2dcaf74/b8471/lanes.png 2016w" sizes="(max-width: 790px) 100vw, 790px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy">
    </span>
<p>Reconciler(렌더링 모듈)는 현재 렌더링 대상인 차선들(<code class="language-text">renderLanes</code>, Lane의 집합, 이하 Lanes)을 들고 있고 해당 Lane 위에 올라가 있는 업데이트들이 배치처리되는 구조입니다.</p>
<h2 id="이벤트와-lane의-우선순위" style="position:relative;"><a href="#%EC%9D%B4%EB%B2%A4%ED%8A%B8%EC%99%80-lane%EC%9D%98-%EC%9A%B0%EC%84%A0%EC%88%9C%EC%9C%84" aria-label="이벤트와 lane의 우선순위 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이벤트와 Lane의 우선순위</h2>
<p>앞서 업데이트에는 종류가 있다고 말씀드렸습니다. 이런 분류의 기준은 업데이트의 시작점입니다. 이 시작점은 DOM 이벤트일 수도 있고 비동기, 전환 이벤트일 수도 있습니다. 다음과 같이 Lane은 하나의 시작점 이벤트에 대응합니다.</p>
<ul>
<li>
<p>SyncLane: 사용자의 물리적 행위 중 개별적으로 처리해야 하는 이벤트(DiscreteEvent)</p>
<ul>
<li>click, input, mouse down, submit…</li>
</ul>
</li>
<li>
<p>InputContinuousLane: 사용자의 물리적 행위 중 연속적으로 발생하는 이벤트(ContinuousEvent)</p>
<ul>
<li>drag, scroll, mouse move, wheel…</li>
</ul>
</li>
<li>
<p>DefaultLane: 기타 모든 이벤트, 리액트 외부에서 발생한 업데이트</p>
<ul>
<li>setTimeout, Promise..</li>
</ul>
</li>
<li>
<p>TransitionLane: 개발자가 정의한 전환 이벤트</p>
<ul>
<li>startTransition(), useTransition()를 통해 생성된 업데이트</li>
</ul>
</li>
</ul>
<p>시작점인 이벤트에는 대응하는 Lane과 같은 우선순위를 가지고 있습니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactEventPriorities.new.js#L24-L27">reconciler > ReactEventPriorities.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">const</span> DiscreteEventPriority <span class="token operator">=</span> SyncLane<span class="token punctuation">;</span>
<span class="token keyword">const</span> ContinuousEventPriority <span class="token operator">=</span> InputContinuousLane<span class="token punctuation">;</span>
<span class="token keyword">const</span> DefaultEventPriority <span class="token operator">=</span> DefaultLane<span class="token punctuation">;</span>
<span class="token keyword">const</span> IdleEventPriority <span class="token operator">=</span> IdleLane<span class="token punctuation">;</span></code></pre></div>
<p>해당 이벤트별로 분류되는 DOM 이벤트는 다음의 링크에서 더 자세히 확인할 수 있습니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-dom/src/events/ReactDOMEventListener.js#L410-L515">react-dom-bindings > events > ReactDOMEventListener.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">getEventPriority</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">domEventName</span><span class="token operator">:</span> DOMEventName</span><span class="token punctuation">)</span><span class="token operator">:</span> EventPriority <span class="token punctuation">{</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>domEventName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'click'</span><span class="token operator">:</span>
    …
    <span class="token keyword">case</span> <span class="token string">'input'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> DiscreteEventPriority<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'drag'</span><span class="token operator">:</span>
    …
    <span class="token keyword">case</span> <span class="token string">'wheel'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> ContinuousEventPriorit<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> DefaultEventPriority<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Lane은 우측에 위치할수록 우선순위가 높기 때문에 <code class="language-text">SyncLane(DiscreteEventPriority) - InputContinuousLane(ContinuousEventPriorit) - DefaultLane(DefaultEventPriority) - TransitionLane</code> 순으로 우선순위가 높습니다.</p>
<h2 id="업데이트에-lane-할당하기" style="position:relative;"><a href="#%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8%EC%97%90-lane-%ED%95%A0%EB%8B%B9%ED%95%98%EA%B8%B0" aria-label="업데이트에 lane 할당하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>업데이트에 Lane 할당하기</h2>
<p>시작점 이벤트와 Lane은 대응되기 때문에 시작점을 판단할 수 있다면 이때 생성된 업데이트에 적절한 Lane을 할당할 수 있습니다.
업데이트에 Lane을 할당하는 시점은 개발자가 useState()의 setState() API를 사용하여 상태를 변경할 때 입니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberHooks.new.js#L2243-L22515">reconciler > ReactFiberHooks.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">dispatchSetState</span><span class="token punctuation">(</span><span class="token parameter">fiber<span class="token punctuation">,</span> queue<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">const</span> lane <span class="token operator">=</span> <span class="token function">requestUpdateLane</span><span class="token punctuation">(</span>fiber<span class="token punctuation">)</span> <span class="token comment">// 업데이트에 할당할 Lane을 요청합니다.</span>

  <span class="token keyword">const</span> update <span class="token operator">=</span> <span class="token punctuation">{</span>
    lane<span class="token punctuation">,</span> <span class="token comment">// Lane 할당</span>
    action<span class="token punctuation">,</span>
    <span class="token literal-property property">hasEagerState</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">eagerState</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">next</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">:</span> any<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">requestUpdateLane()</code>은 다음의 환경을 순차적으로 탐색하며 업데이트의 우선순위를 찾습니다.</p>
<h3 id="dom-이벤트" style="position:relative;"><a href="#dom-%EC%9D%B4%EB%B2%A4%ED%8A%B8" aria-label="dom 이벤트 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DOM 이벤트</h3>
<p>DOM 이벤트 분류에 따라서 리액트 내부적으로 구축한 이벤트 시스템 위에 다음과 같이 핸들러가 구성되어 있습니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-dom/src/events/ReactDOMEventListener.js#L86-L173">react-dom > events > ReactDOMEventListener.js</a></p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token comment">// click, input 등의 이벤트 핸들러로 등록되어 있습니다.</span>
<span class="token keyword">function</span> <span class="token function">dispatchDiscreteEvent</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">domEventName</span><span class="token operator">:</span> DOMEventName<span class="token punctuation">,</span>
  <span class="token literal-property property">eventSystemFlags</span><span class="token operator">:</span> EventSystemFlags<span class="token punctuation">,</span>
  <span class="token literal-property property">container</span><span class="token operator">:</span> EventTarget<span class="token punctuation">,</span>
  <span class="token literal-property property">nativeEvent</span><span class="token operator">:</span> AnyNativeEvent<span class="token punctuation">,</span></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> previousPriority <span class="token operator">=</span> <span class="token function">getCurrentUpdatePriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">setCurrentUpdatePriority</span><span class="token punctuation">(</span>DiscreteEventPriority<span class="token punctuation">)</span><span class="token punctuation">;</span></span>    <span class="token function">dispatchEvent</span><span class="token punctuation">(</span>domEventName<span class="token punctuation">,</span> eventSystemFlags<span class="token punctuation">,</span> container<span class="token punctuation">,</span> nativeEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token function">setCurrentUpdatePriority</span><span class="token punctuation">(</span>previousPriority<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">dispatchContinuousEvent</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">.</span><span class="token punctuation">.</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
<span class="token comment">/*...*/</span></code></pre></div>
<p><code class="language-text">requestUpdateLane()</code>에서는 <code class="language-text">setCurrentUpdatePriority()</code>가 설정한 우선순위를 참조하게 됩니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberWorkLoop.new.js#L504-L507">reconciler > ReactFiberWorkLoop.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">requestUpdateLane</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">fiber</span><span class="token operator">:</span> Fiber</span><span class="token punctuation">)</span><span class="token operator">:</span> Lane <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">const</span> <span class="token literal-property property">updateLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token function">getCurrentUpdatePriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setCurrentUpdatePriority()에서 설정한 값을 가져온다</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>updateLane <span class="token operator">!==</span> NoLane<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> updateLane<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="리액트-외부-이벤트" style="position:relative;"><a href="#%EB%A6%AC%EC%95%A1%ED%8A%B8-%EC%99%B8%EB%B6%80-%EC%9D%B4%EB%B2%A4%ED%8A%B8" aria-label="리액트 외부 이벤트 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>리액트 외부 이벤트</h3>
<p>리액트 이벤트 시스템 외부에서 발생할 경우, 내부 핸들러를 통해 우선순위를 설정할 수 없습니다. 이때는 호스트 시스템을 통해 이벤트를 먼저 확인하고 여기에 해당하지 않는다면 <code class="language-text">DefaultEventPriority</code>를 할당하게 되어있습니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberWorkLoop.new.js#L515-L516">reconciler > ReactFiberWorkLoop.js</a></p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">requestUpdateLane</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">fiber</span><span class="token operator">:</span> Fiber</span><span class="token punctuation">)</span><span class="token operator">:</span> Lane <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">const</span> <span class="token literal-property property">updateLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token function">getCurrentUpdatePriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>updateLane <span class="token operator">!==</span> NoLane<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> updateLane
  <span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> <span class="token literal-property property">eventLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">getCurrentEventPriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> any<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">return</span> eventLane</span><span class="token punctuation">}</span></code></pre></div>
<p><a class="code_link_6" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-dom/src/client/ReactDOMHostConfig.js#L368-L374">react-dom > client > ReactDOMHostConfig.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">getCurrentEventPriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> EventPriority <span class="token punctuation">{</span>
  <span class="token keyword">const</span> currentEvent <span class="token operator">=</span> window<span class="token punctuation">.</span>event<span class="token punctuation">;</span> <span class="token comment">// 리액트 이벤트 시스템 외부에서 발생했어도 이벤트를 참조할 수 있는지 다시 확인한다.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>currentEvent <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> DefaultEventPriority<span class="token punctuation">;</span> <span class="token comment">// setTimeout, Promise는 여기에 해당합니다.</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">getEventPriority</span><span class="token punctuation">(</span>currentEvent<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="전환-이벤트" style="position:relative;"><a href="#%EC%A0%84%ED%99%98-%EC%9D%B4%EB%B2%A4%ED%8A%B8" aria-label="전환 이벤트 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>전환 이벤트</h3>
<p>Transition Lane을 할당할 업데이트는 <code class="language-text">useTransition()</code>,<code class="language-text">startTransition()</code> API를 통해서 개발자가 결정합니다. 해당 API를 통해서 생성된 업데이트는 내부적으로 특별한 플래그를 세우게 됩니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react/src/ReactStartTransition.js#L18-L35">react > ReactStartTransition.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token parameter">scope<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> prevTransition <span class="token operator">=</span> ReactCurrentBatchConfig<span class="token punctuation">.</span>transition<span class="token punctuation">;</span>
  ReactCurrentBatchConfig<span class="token punctuation">.</span>transition <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">scope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    ReactCurrentBatchConfig<span class="token punctuation">.</span>transition <span class="token operator">=</span> prevTransition<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">ReactCurrentBatchConfig</code>는 리액트 내부에서 전역적으로 사용되는 객체입니다. 해당 객체를 업데이트 생성 시점에 참조하여 업데이트가 전환 업데이트인지 판단합니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberWorkLoop.new.js#L474-L496">reconciler > ReactFiberWorkLoop.js</a></p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">requestUpdateLane</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">fiber</span><span class="token operator">:</span> Fiber</span><span class="token punctuation">)</span><span class="token operator">:</span> Lane <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> isTransition <span class="token operator">=</span> <span class="token function">requestCurrentTransition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!==</span> NoTransition<span class="token punctuation">;</span> <span class="token comment">// ReactCurrentBatchConfig.transition !== null</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>isTransition<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentEventTransitionLane <span class="token operator">===</span> NoLane<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      currentEventTransitionLane <span class="token operator">=</span> <span class="token function">claimNextTransitionLane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 할당 가능한 Transition Lane을 요청한다.</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">return</span> currentEventTransitionLane<span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span>
  <span class="token keyword">const</span> <span class="token literal-property property">updateLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token function">getCurrentUpdatePriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>updateLane <span class="token operator">!==</span> NoLane<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> updateLane
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token literal-property property">eventLane</span><span class="token operator">:</span> Lane <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">getCurrentEventPriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> any<span class="token punctuation">)</span>
  <span class="token keyword">return</span> eventLane
<span class="token punctuation">}</span></code></pre></div>
<p>Transition Lane(+ Retry Lane)은 다른 Lane들과는 다르게 Lane이 여러 개입니다. 그래서 전환 업데이트는 생성 시점에 따라 같은 전환 업데이트라도 다른 Transition Lane에 할당될 수 있습니다. 지금은 별로 중요한 내용은 아니니 다음 Transition Lane 글에서 자세히 다룹니다.</p>
<h1 id="렌더링을-진행할-lane-선택하기" style="position:relative;"><a href="#%EB%A0%8C%EB%8D%94%EB%A7%81%EC%9D%84-%EC%A7%84%ED%96%89%ED%95%A0-lane-%EC%84%A0%ED%83%9D%ED%95%98%EA%B8%B0" aria-label="렌더링을 진행할 lane 선택하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>렌더링을 진행할 Lane 선택하기</h1>
<p>리액트 18은 우선순위 기반으로 렌더링을 진행합니다. 우선순위가 낮은 업데이트와 높은 업데이트를 따로 렌더링한다는 의미입니다. 이를 위해 렌더링 대기 중인 Lanes에서 우선순위가 가장 높은 Lane을 뽑아낼 수 있어야 합니다. 이 작업은 렌더링 시작 전에 <code class="language-text">getNextLanes()</code>에서 이루어집니다.</p>
<blockquote>
<p>그리고 이 과정에서 렌더링 중이던 Lane보다 우선순위가 더 높은 Lane이 뽑힐 수도 있습니다. 이를 동시성 렌더링에서의 <strong>Interrupt</strong>라고 합니다. 이렇게 되면 자연스럽게 이전 렌더링 작업은 폐기 처리되고 신규 Lane을 기준으로 렌더링을 다시 시작하게 됩니다.</p>
</blockquote>
<p>렌더링 작업은 단일 Lane일 수도 있지만 복수개의 Lanes일 수도 있습니다. 같은 종류의 업데이트는 모두 배치처리됩니다. 즉, 전환 업데이트가 다른 시점에 생성되어 다른 Transition Lane에 할당되었어도 항상 배치처리 된다는 의미입니다.</p>
<p>이제 렌더링 작업을 진행할 Lanes를 어떻게 뽑아내는지 확인해보겠습니다(요약한 코드입니다. 실제 코드는 <a href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberLane.new.js#L188" target="blank">여기</a>를 확인하세요).</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getNextLanes</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> wipLanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> pendingLanes <span class="token operator">=</span> root<span class="token punctuation">.</span>pendingLanes</span><span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>pendingLanes <span class="token operator">===</span> NoLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>    <span class="token keyword">return</span> NoLanes
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> nextLanes <span class="token operator">=</span> NoLanes
  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code></pre></div>
<p>먼저 렌더링 보류 중인 Lanes를 <code class="language-text">root</code>를 통해서 참조합니다. <code class="language-text">root</code>의 <code class="language-text">pendingLanes</code>는 업데이트에 Lane을 할당할 때 root에도 같이 기록되며(<a href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberLane.new.js#L575-L580" target="blank">dispatchSetState() -> scheduleUpdateOnFiber() -> markRootUpdated()</a>), VDOM 전체에 발생한 업데이트를 참조하기 위해 사용됩니다.</p>
<blockquote>
<p>root는 VDOM에서의 전역 컨텍스트라고 생각하시면 되겠습니다.</p>
</blockquote>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getNextLanes</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> wipLanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">let</span> nextLanes <span class="token operator">=</span> NoLanes

<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> suspendedLanes <span class="token operator">=</span> root<span class="token punctuation">.</span>suspendedLanes</span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> pingedLanes <span class="token operator">=</span> root<span class="token punctuation">.</span>pingedLanes</span>  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">suspendedLanes</code>과 <code class="language-text">pingedLanes</code>는 Suspense 컴포넌트와 연관되어 있습니다. <code class="language-text">suspendedLanes</code>는 IO-Bound인 렌더링에서 보류 처리(네트워크 요청으로부터 데이터가 아직 도착하지 않은)된 Lanes이며, <code class="language-text">pingedLanes</code>는 보류된 상태가 해결(네트워크 요청이 완료되어 데이터가 준비된)되었지만 아직 렌더링을 진행하지 못한 Lanes를 의미합니다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getNextLanes</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> wipLanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">const</span> suspendedLanes <span class="token operator">=</span> root<span class="token punctuation">.</span>suspendedLanes
  <span class="token keyword">const</span> pingedLanes <span class="token operator">=</span> root<span class="token punctuation">.</span>pingedLanes

<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> nonIdlePendingLanes <span class="token operator">=</span> pendingLanes <span class="token operator">&amp;</span> NonIdleLanes</span>  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code></pre></div>
<p>렌더링 작업에 포함하지 않을 Lane들을 제거합니다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre style="counter-reset: linenumber 0" class="language-js line-numbers"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getNextLanes</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> wipLanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">const</span> nonIdlePendingLanes <span class="token operator">=</span> pendingLanes <span class="token operator">&amp;</span> NonIdleLanes

<span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>nonIdlePendingLanes <span class="token operator">!==</span> NoLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> nonIdleUnblockedLanes <span class="token operator">=</span> nonIdlePendingLanes <span class="token operator">&amp;</span> <span class="token operator">~</span>suspendedLanes</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>nonIdleUnblockedLanes <span class="token operator">!==</span> NoLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      nextLanes <span class="token operator">=</span> <span class="token function">getHighestPriorityLanes</span><span class="token punctuation">(</span>nonIdleUnblockedLanes<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      <span class="token keyword">const</span> nonIdlePingedLanes <span class="token operator">=</span> nonIdlePendingLanes <span class="token operator">&amp;</span> pingedLanes</span><span class="gatsby-highlight-code-line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>nonIdlePingedLanes <span class="token operator">!==</span> NoLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">        nextLanes <span class="token operator">=</span> <span class="token function">getHighestPriorityLanes</span><span class="token punctuation">(</span>nonIdlePingedLanes<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span>  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>기본적으로 렌더링 보류 중인 <code class="language-text">suspendedLanes</code>는 제외<up>6</up>합니다. 그리고 보류되었다가 데이터가 도착한(suspend -> ping) <code class="language-text">pingedLanes</code>는 CPU-Bound Lanes보다 우선순위에 밀리는 모습<up>7</up>을 확인할 수 있습니다.</p>
<p><code class="language-text">getHighestPriorityLanes()</code>는 현재 보류 중인 Lanes에서 우선순위가 가장 높은 Lane과 해당 Lane 그룹에 속하는 보류 중인 Lanes도 배치처리하기 위해 포함하여 반환합니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberLane.new.js#L132">reconciler > ReactFiberLane.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">getHighestPriorityLanes</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">lanes</span><span class="token operator">:</span> Lanes <span class="token operator">|</span> Lane</span><span class="token punctuation">)</span><span class="token operator">:</span> Lanes <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">getHighestPriorityLane</span><span class="token punctuation">(</span>lanes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Lanes중 가장 우선순위가 높은 Lane을 선택한다.</span>
    <span class="token keyword">case</span> <span class="token literal-property property">SyncLane</span><span class="token operator">:</span>
          <span class="token keyword">return</span> SyncLane<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token literal-property property">InputContinuousLane</span><span class="token operator">:</span>
      <span class="token keyword">return</span> InputContinuousLane<span class="token punctuation">;</span>
    <span class="token comment">/*...*/</span>
    <span class="token keyword">case</span> <span class="token literal-property property">TransitionLane1</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token literal-property property">TransitionLane2</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token literal-property property">TransitionLane16</span><span class="token operator">:</span>
        <span class="token keyword">return</span> lanes <span class="token operator">&amp;</span> TransitionLanes<span class="token punctuation">;</span>
    <span class="token comment">/*...*/</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>만약 <code class="language-text">lanes</code>에 <code class="language-text">TransitionLane1</code>, <code class="language-text">TransitionLane2</code>, <code class="language-text">RetryLane1</code>이 포함되어 있다면 가장 우선순위가 높은 <code class="language-text">TransitionLane1</code>이 선택되고 반환될 때는 같은 그룹인 <code class="language-text">Transition Lane2</code>도 포함하여 반환됩니다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getNextLanes</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> wipLanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nonIdlePendingLanes <span class="token operator">!==</span> NoLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/*...*/</span>
  <span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>nextLanes <span class="token operator">===</span> NoLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">return</span> NoLanes</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span>  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code></pre></div>
<p>여기서 <code class="language-text">nextLanes</code>가 <code class="language-text">NoLanes</code>라면 보류 중인 Lanes 중 현재 렌더링을 진행해야 할 Lane이 없다는 의미입니다. <code class="language-text">NoLanes</code>를 반환하여 렌더링 작업을 진행하지 않도록 합니다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre style="counter-reset: linenumber 0" class="language-js line-numbers"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getNextLanes</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> wipLanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nextLanes <span class="token operator">===</span> NoLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> NoLanes
  <span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>wipLanes <span class="token operator">!==</span> NoLanes <span class="token operator">&amp;&amp;</span> wipLanes <span class="token operator">!==</span> nextLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> nextLane <span class="token operator">=</span> <span class="token function">getHighestPriorityLane</span><span class="token punctuation">(</span>nextLanes<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> wipLane <span class="token operator">=</span> <span class="token function">getHighestPriorityLane</span><span class="token punctuation">(</span>wipLanes<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span></span><span class="gatsby-highlight-code-line">      nextLane <span class="token operator">>=</span> wipLane <span class="token operator">||</span></span><span class="gatsby-highlight-code-line">      <span class="token punctuation">(</span>nextLane <span class="token operator">===</span> DefaultLane <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>wipLane <span class="token operator">&amp;</span> TransitionLanes<span class="token punctuation">)</span> <span class="token operator">!==</span> NoLanes<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      <span class="token keyword">return</span> wipLanes</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span></span>  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p><code class="language-text">wipLanes</code>는 동시성 렌더링에서 렌더링 중인 Lanes을 저장하는 변수입니다. 해당 변수가 있다는 건 렌더링이 진행 중이었다는 의미입니다<up>7</up>. 렌더링이 진행 중이었으니 이전 렌더링보다 우선순위가 높은 업데이트가 있는지 확인해서 Interrupt 할지 결정해야 합니다.</p>
<p>이전 렌더링을 계속 이어갈 것이라면 <code class="language-text">wipLanes</code>를 반환<up>14</up>합니다. 만약 렌더링 중이었고<up>7</up> <code class="language-text">nextLane</code>가 <code class="language-text">wipLane</code> 보다 우선순위가 더 높다면<up>11</up> 이전 렌더링을 Interrupt 합니다.</p>
<p>추가로, <code class="language-text">DefaultLane</code>이 <code class="language-text">TransitionLane</code> 보다 우선순위가 더 높지만 이미 전환 업데이트가 렌더링 중이라면 Interrupt 하지 않는 걸 확인할 수 있습니다<up>12</up>.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getNextLanes</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> wipLanes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*...*/</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>wipLanes <span class="token operator">!==</span> NoLanes <span class="token operator">&amp;&amp;</span> wipLanes <span class="token operator">!==</span> nextLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/*...*/</span>
  <span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">return</span> nextLanes</span><span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">nextLanes</code>를 반환합니다. 이제 Reconciler는 반환받은 Lanes를 기반으로 VDOM을 탐색하며 렌더링을 진행합니다. 이 과정은 root에 <code class="language-text">pendingLanes</code>가 더 이상 없을 때까지 반복될 것입니다.</p>
<h1 id="lane-기반의-렌더링-탐색" style="position:relative;"><a href="#lane-%EA%B8%B0%EB%B0%98%EC%9D%98-%EB%A0%8C%EB%8D%94%EB%A7%81-%ED%83%90%EC%83%89" aria-label="lane 기반의 렌더링 탐색 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lane 기반의 렌더링 탐색</h1>
<p>Lane은 사실 업데이트에만 할당되지 않습니다. Lane은 업데이트의 우선순위와 배치 여부로만 해석하는 것이 아닌 업데이트 발생 여부를 판단할 때도 사용됩니다.</p>
<p>업데이트가 발생했다면 업데이트가 VDOM의 어느 노드에서 발생했는지 기록해야 합니다. 이를 위해 상태가 변경된 노드(fiber)에 업데이트가 발생했음을 <code class="language-text">lanes</code>에 기록하고, 해당 노드의 부모부터 최상단 노드까지는 하위 트리에 업데이트가 발생했을음 <code class="language-text">childLanes</code>에 기록합니다. 이것은 추후에 Reconciler가 Lanes를 기준으로 렌더링할 때 렌더링 대상 컴포넌트를 찾아가는 데에 활용됩니다.</p>
<p><a class="code_link" target="blink" href="hhttps://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberConcurrentUpdates.new.js#L170">reconciler > ReactFiberConcurrentUpdates.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">function</span> <span class="token function">markUpdateLaneFromFiberToRoot</span><span class="token punctuation">(</span><span class="token parameter">sourceFiber<span class="token punctuation">,</span> update<span class="token punctuation">,</span> lane</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 상태가 변경된 노드에 업데이트가 발생했음을 새긴다.</span>
  fiber<span class="token punctuation">.</span>lanes <span class="token operator">=</span> <span class="token function">mergeLanes</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>lanes<span class="token punctuation">,</span> lane<span class="token punctuation">)</span>
  <span class="token keyword">const</span> alternate <span class="token operator">=</span> fiber<span class="token punctuation">.</span>alternate
  <span class="token keyword">if</span> <span class="token punctuation">(</span>alternate <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    alternate<span class="token punctuation">.</span>lanes <span class="token operator">=</span> <span class="token function">mergeLanes</span><span class="token punctuation">(</span>alternate<span class="token punctuation">.</span>lanes<span class="token punctuation">,</span> lane<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 하위 노드에 업데이트가 발생했음을 새긴다.</span>
  <span class="token keyword">let</span> parent <span class="token operator">=</span> sourceFiber<span class="token punctuation">.</span>return<span class="token punctuation">;</span>
  <span class="token keyword">let</span> node <span class="token operator">=</span> sourceFiber<span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    parent<span class="token punctuation">.</span>childLanes <span class="token operator">=</span> <span class="token function">mergeLanes</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>childLanes<span class="token punctuation">,</span> lane<span class="token punctuation">)</span><span class="token punctuation">;</span>
    alternate <span class="token operator">=</span> parent<span class="token punctuation">.</span>alternate<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>alternate <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      alternate<span class="token punctuation">.</span>childLanes <span class="token operator">=</span> <span class="token function">mergeLanes</span><span class="token punctuation">(</span>alternate<span class="token punctuation">.</span>childLanes<span class="token punctuation">,</span> lane<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    node <span class="token operator">=</span> parent<span class="token punctuation">;</span>
    parent <span class="token operator">=</span> parent<span class="token punctuation">.</span>return<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>렌더링은 항상 root부터 시작하기 때문에 위에서도 언급했지만 VDOM에서 발생한 업데이트에 할당된 렌더링 보류 중인 Lanes를 알고 있어야 합니다. 그래서 업데이트 발생 시점에 root의 <code class="language-text">pendingLanes</code>에도 Lane을 기록합니다.</p>
<p><a class="code_link" target="blink" href="https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberLane.new.js#L575-L580">reconciler > ReactFiberLane.js</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">‎
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">markRootUpdated</span><span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">root</span><span class="token operator">:</span> FiberRoot<span class="token punctuation">,</span>
  <span class="token literal-property property">updateLane</span><span class="token operator">:</span> Lane<span class="token punctuation">,</span>
  <span class="token literal-property property">eventTime</span><span class="token operator">:</span> number</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  root<span class="token punctuation">.</span>pendingLanes <span class="token operator">|=</span> updateLane
  <span class="token comment">/*...*/</span>
<span class="token punctuation">}</span></code></pre></div>
<hr>
<p>Lane이 도입된 배경과 업데이트에 Lane을 할당하고 렌더링 대상을 선택하는 과정을 확인했습니다. 하지만 아직 Lane 기반의 렌더링 과정을 확인하지는 않았습니다. 이는 다음 Transition Lane 글에서 전환이 무엇이고 Transition Lane이 세부적으로 어떻게 처리되는지 확인하면서 같이 확인하게 될 것입니다.</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn-1">
<p>Expiration Time의 정의는 <a target="blank" href="/react/in-depth-react-hooks_1#expirationtime">이전 포스터</a>에서 확인하세요.</p>
<a href="#fnref-1" class="footnote-backref">↩</a>
</li>
<li id="fn-2">
<p>모드 방식은 리액트 18에서는 제거되었습니다.</p>
<a href="#fnref-2" class="footnote-backref">↩</a>
</li>
</ol>
</div></div><hr class="custom-hr"/><div class="bio"><div class="author"><div class="author-description"><a class="link" href="/"><img class="author-image" src="/static/felog-f24356c48475809626ea0c2ac67855c6.png" style="width:72px;height:79px"/></a><div class="author-name"><div><a class="author-name-content"><div><div style="float:left"><svg aria-hidden="true" focusable="false" class="bio_fontaswesome" data-prefix="fas" data-icon="envelope" role="img" width="1em" display="inline-block" font-size="inherit" height="1em" overflow="visible" viewBox="0 0 496 512"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg> <!-- -->kgc4958@gmail.com</div></div></a></div><div class="author-introduction">오픈소스를 톺아보며 매직 코드라 생각했던 부분들의 동작 원리와 의미, 의도를 파악해보고 서로의 생각을 나누기 위한 블로그</div></div></div></div></div><ul class="navigator"><li class="left_navi"><a rel="prev" href="/react/in-depth-react18-intro/">← <!-- -->React 18 톺아보기 - 01. Intro</a></li><li class="right_navi"><a rel="next" href="/react/in-depth-react18-transition_1/">React 18 톺아보기 - 03. Transition Lane_1<!-- --> →</a></li></ul><div class="utterences"></div><footer class="footer">©<a>Goidle</a>, Built with<!-- --> <a href="https://github.com/JaeYeopHan/gatsby-starter-bee">Gatsby-starter-bee</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WZKRVFR10G"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-WZKRVFR10G', {"send_page_view":false});gtag('config', 'UA-154981109-1', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/react/in-depth-react18-lane/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-3df9f584718eda9580a2.js"],"app":["/app-fe38415449496a7ca990.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-44ceac2081f421b30e8f.js"],"component---src-pages-404-js":["/component---src-pages-404-js-2a7b760bae899f5e9b0c.js"],"component---src-pages-index-js":["/component---src-pages-index-js-b4c60ce3b2e714c9e16c.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-e199dfe7aaf4d1d814d2.js"]};/*]]>*/</script><script src="/polyfill-3df9f584718eda9580a2.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-e199dfe7aaf4d1d814d2.js" async=""></script><script src="/cd7d5f864fc9e15ed8adef086269b0aeff617554-6020d22b933a677a17bf.js" async=""></script><script src="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-37f4b6ff0ea9acd778e4.js" async=""></script><script src="/styles-0ec71dd62c66cb95665c.js" async=""></script><script src="/app-fe38415449496a7ca990.js" async=""></script><script src="/framework-8de36d3fd07627b19105.js" async=""></script><script src="/webpack-runtime-bc5c486950fc7f0073c7.js" async=""></script></body></html>