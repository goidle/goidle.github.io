{"componentChunkName":"component---src-templates-blog-post-js","path":"/react/in-depth-react18-transition_1/","result":{"data":{"site":{"siteMetadata":{"title":"Deep Dive Magic Code","author":"Goidle","comment":{"utterances":"goidle/goidle.github.io"}}},"markdownRemark":{"id":"a349c215-0221-5290-b819-a2c8764e621f","excerpt":"Transition Transition Lane을 알아보기에 앞서 전환(Transition)에 대해서 좀 더 익숙해질 필요가 있습니다. 다행히 React 18 Working Group에서 startTransition API에 대해 예제와 함께 친절히 설명하는 내용이 있습니다(참고). 이 내용을 바탕으로 살을 조금 더 보태어 전환을 완전히 이해하고 넘어가겠습니다. 다음은 슬라이더의 스코어에 따라서 버블 차트를 렌더링하는 어플리케이션 입니다. 사용함에 있어서 별문제가 없어 보입니다. CPU…","html":"<h1 id=\"transition\" style=\"position:relative;\"><a href=\"#transition\" aria-label=\"transition permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Transition</h1>\n<p>Transition Lane을 알아보기에 앞서 전환(Transition)에 대해서 좀 더 익숙해질 필요가 있습니다.<br>\n다행히 React 18 Working Group에서 startTransition API에 대해 예제와 함께 친절히 설명하는 내용이 있습니다(<a href=\"https://github.com/reactwg/react-18/discussions/65\" target=\"blank\">참고</a>). 이 내용을 바탕으로 살을 조금 더 보태어 전환을 완전히 이해하고 넘어가겠습니다.</p>\n<p>다음은 슬라이더의 스코어에 따라서 버블 차트를 렌더링하는 어플리케이션 입니다.</p>\n<video controls width=\"100%\">\n <source src=\"/path/to/dir/dcbc77c9f458615a4c7db7b83e5fad05/play_app.mp4\" type=\"video/mp4\" />\n</video>\n<p>사용함에 있어서 별문제가 없어 보입니다. CPU에 Throttling을 걸어보겠습니다.</p>\n<video controls width=\"100%\">\n <source src=\"/path/to/dir/b551946ae7560bfbd8b1b0554ef2f5fa/app_throttling.mp4\" type=\"video/mp4\" />\n</video>\n<p>무엇이 문제일까요? 메인 스레드를 들여다보겠습니다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 790px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.56565656565656%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABcSAAAXEgFnn9JSAAAC7klEQVQoz1WSTU8bVxSG50+0KQE8nq873x82NmAmpsFx/AGOwXENDsaYQjBQSBW6SlCktJWiSqlUddsq+yz6D+Kq6qadRZWyqPoLIq+i/oHGd96eIasuHp336sx977nvHYHp/k+GlfmHGf4bTffGjDljRTXHidbNYGwQSdUY9Qx/rGjOWFLs/yEr1htJsd4qiv2zoKj2L5aVgefmYNoBmO5AVS2omg3bzUBM66QteF4GgT9H32VgWy4c24Nt+6R9mGYAL8jBsoK/hPnF0qtWexvD4dm77f4e39we8PbmDu90+7y/t8/ra22+uXWPfzbc4/f39/nJ4S4/ub/DjxMO+/zw0wM+GBxNjk5P0Wxv/Sm4fmFUCMsoLlcnlcoGNlZb2Kjdwd36OuqVFkq3VlG+WUUlXEHtRgm1sIR6+L5Wl1bQKN5Cu9zg9XILvr94KUzPaKO5IMBW4+NJ1s8h62SxQNeaM13kMvP44EMRYT6Pg7ur6NZuY9ip48G9Bs66a3jYa6BXq+P2wjLPzxVA+V4Ks7NspCo6sp4z0Sg7WaUMmQdmUq5BAVNTIkqlBk5PH6PdHuDxo2/w1dPv8SXx7fMXaK73IMomV1UbkmReCqKoj2ZTGqZn2IQ06KXoEVwYZhaOu4ipj2YRLjexd/w11lqHOD7/DucXP+CLJy9w8ewlqo0B0mmdy7JF1bgUUik2EkVGCzahRixJBmHGjPmx7czH16fEOL9Qjtvds7h+Zzcenj2L+wcX8c7+o/jk4fN4eWUj2cNpT2J8ZfhKFDWQ6b/JSSmR8VRK4/R/cc0I+PR1iQfZIq+s9XiV6O6e82bn6IpPdj7n80tVTjd8R9OBvF4nhr8mE76fUkea6gxFkNMzWLLyuDYjIXQW0VmooUUMb3bQC5voFdcxKDax4oUIVBdyYiiyvwVJsn5UVec15fabprkRZRGJaSNyVC/yVD9KkTZkO/IVNwqIghZEgexerbPUt2QnclXvd1ky/xDT5sv/AGKqZSGAmswSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"blocking\" title=\"blocking\" src=\"/static/ecebeb8898b9a662c1cd3873fab45e19/2e237/blocking.png\" srcset=\"/static/ecebeb8898b9a662c1cd3873fab45e19/18f77/blocking.png 198w,\n/static/ecebeb8898b9a662c1cd3873fab45e19/2cb6c/blocking.png 395w,\n/static/ecebeb8898b9a662c1cd3873fab45e19/2e237/blocking.png 790w,\n/static/ecebeb8898b9a662c1cd3873fab45e19/471ef/blocking.png 1185w,\n/static/ecebeb8898b9a662c1cd3873fab45e19/91b67/blocking.png 1527w\" sizes=\"(max-width: 790px) 100vw, 790px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>마우스 다운 이벤트 이후에 일련의 마우스 무브 이벤트들이 발생했습니다. 문제는 특정 마우스 무브의 렌더링 작업이 앱이 멈추었다고 느낄 수 있을 정도로 긴 시간이 걸렸습니다. 그리고 이 시간동안 사용자는 차단됩니다.</p>\n<p>리액트는 이 문제를 어떻게 바라보았을까요? 이미 해답은 Intro에서 언급했습니다.</p>\n<blockquote>\n<p><strong>”</strong>사용자는 물리적인 행위에 대해서 즉각적인 반응을 기대한다. 그렇지않다면 사용자는 뭔가 잘못되고 있다고 느낄 수 있다.\n반면 A0 -> A1의 전환은 느릴수 있다고 무의식적으로 인지하고 있으며, 모든 전환에 대한 즉각적인 반응을 기대하지 않는다.<strong>”</strong></p>\n</blockquote>\n<p>즉, “사용자 액션의 응답을 최우선적으로 처리하고 난 후 전환에 대한 응답을 처리하자.”입니다.</p>\n<p>위 내용을 바탕으로 사용자와 밀접한 UI와 전환 UI를 구분합니다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 790px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 62.121212121212125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABcSAAAXEgFnn9JSAAACVUlEQVQoz2WSe0/aUBjG+aJ+hf07kyX7Y8uSuVsWNzcchdJTwLnFZHGLKFUuQha2yMUxEkUM0hYUr5RJUWDn2XsKU8AmT0/TvOf3/s7FxdhC5828ipfvGN57VHi9DLIchF8JQfaHoNBINWNRlEFezCm4PyNh+pkXj17Lopa7VLZg33vsxtT0LH/rljkBuUdiXPYxrviDnMCcUZSJqCzEfXKQu6UAn6d4fEHRjLvoZXskBRQBg8+ngmB48NSNV3PU1R+ATw44ppOhRiCwCGcsNDAUQJkmEIgHAotQ1Y9Y+7aGbCqPcsVA86KJXO4XJGoq6oa1IwnQNqkko94aiiIvAUVXUbS6ugGrcQLLstC5uoZeNRAOa/R/HWHKuhalxBCJRCkb0LQYX15eGTckA+73BwUYsfU4umcW+v0+er0+Ltu28w1wiOfwpImLVhsjDzcMU9hzF1Ht4elxsVxJYkgkUjeVducKP4oVnJ5b2DMaqNSOsVs9gtk4Ra97jW635wAPDqoDoDAcbvIQqCAeHwCFld3p4LzZQkk/wkOWwPPFJHYqdRTKJvT6Mdq2PQTq48Bbw1sg/9tH67INbasE/fAUc18zUCI57JNpNFPC77KBswtrHHh3yQKYdIAV89iZtLWjo0hGe9VDMm1gKb6N4n4NqRw1qh05wOqk4eiS/+9hgw6muG+i2fqD2aXvWIpmsZktYWrmCz5F8ygdEHS77AB1fXgodLI3hmIcXBsNZq2OumkiV9hFJJXFSiwNbfMn0pkCnshhRJIZJNJ5fPi8AcOocXFXxdX7B5l0AihPtChEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"app updates\" title=\"app updates\" src=\"/static/d885f1aad03db6614fbb37cda6fbc6d9/2e237/app_updates.png\" srcset=\"/static/d885f1aad03db6614fbb37cda6fbc6d9/18f77/app_updates.png 198w,\n/static/d885f1aad03db6614fbb37cda6fbc6d9/2cb6c/app_updates.png 395w,\n/static/d885f1aad03db6614fbb37cda6fbc6d9/2e237/app_updates.png 790w,\n/static/d885f1aad03db6614fbb37cda6fbc6d9/6be49/app_updates.png 1160w\" sizes=\"(max-width: 790px) 100vw, 790px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>슬라이더는 사용자 행위에 밀접한 UI입니다. 그에 반해 차트는 슬라이더 상태에 따라서 A0 -> A1으로 전환되는 UI입니다. UI를 구분했으니 업데이트 또한 구분해야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>slideValue<span class=\"token punctuation\">,</span> setSlideValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>score<span class=\"token punctuation\">,</span> setScore<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">&lt;</span>Slider onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n <span class=\"token function\">setSlideValue</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n React<span class=\"token punctuation\">.</span><span class=\"token function\">startTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setScore</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>\n<p>이전과 마찬가지로 CPU에 Throttling을 걸어보겠습니다.</p>\n<video controls width=\"100%\">\n <source src=\"/path/to/dir/66332872490c7c4a86b48159dccd710c/app_transition.mp4\" type=\"video/mp4\" />\n</video>\n<p>이전과 다르게 사용자의 액션을 전혀 차단하지 않습니다. 일반 업데이트와 전환 업데이트의 렌더링에는 어떠한 차이점이 있는 걸까요?</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 790px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 80.30303030303031%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABcSAAAXEgFnn9JSAAAD5klEQVQ4y3WSS2/iZhSG+QmtmjQQTABjY2MbjM0txBcwJgRIIOFmEgMJISHTJLjtYlqp0iz6c7rqfpDa39B9pbKo1EVjqa3UXW2f+YAZqarUxaP3vOec73wX2xc5YB9YLv09xQg/0IzwlmbEJUklEallks8veeFwmRaLG9Yxm8wu4zS/jCfSW2j+LZVI/0hS/HchLNH3hcPM5wyT/pvlREgwAiQSPNAUByTJAcuiXCINFM1voFEcjyeB/ADqiVPJTY4iud8wjDZ8QYyyCDL1O50QgGZFJ4IzDk5yDs2JSJMOEU86OME46NQOmxIdguJQD+1EY4wTQ7WDMP1PNMYCTrC/BIPrgUHK0k969uByDpV61ztUGp6it73ru7k3ub72DGPo3c9MxMh7mE+8O6SzSd/r9cfeWe/aqzYNt9mdQPV0sAr4ScOH47zVGd7a41dfwNXs2RvfLeBm/iWMZgsw7xcwvn+Gm1fr3DOMEVPE7Wfb2miG/M2Tezt9hosLc/XpHm749oO0xbEZuygUoMDnPIHNAEmJkOayaw+51BYR+fx7XefXrHsJnHNjUQ7waGK1eUMMvaFyKNntig7nFc1raiWoqBLUSwrUJRlOZBmaigw1SYKmvPWNtS9KUC4cQS6bdZWjAmSE4mpvfeVIlLPqjY592jbgvGt6k+kjXE8foG+M4fTcgBbCuLqFbn8Mg8spdAdjaHeGUK6dQqV2BoPh1H1afA2q0lh99HHQ8EWjKUsuXdhqpQt63fQ6Qwta/ScUj0Ct9BB9aJ7fQRX5emsG1cYIag0TtGMDytUBXE2/cSfzbyElyKvdnRAaiD5KUW7YR0oTNfW9dm8Ore496DUD5FILlHIbaqfjdQ0NvUSnGkD1pI82ugBVuwBz+tqdPrwBIVNa7XyCBkYiSUvMana2UEVNHa/RnqJTmKCg5kOpAQWpjgZdbTyqb1Vrg6SewZHagvbg0R1MXkMqLW0HYqGExSTzdiYjgyrVvHqtB3q1A9JhBbJZBXIor5fR4qIOilwHRaqhWIN8vgxSQYNee+QagzvguNxqdzdi+AiMtkrZ+otaukI7m85x497Va1NX0UauWhq6RXXoapWRK2umq+kTt6SPXbViuorUc3P6jct1vnLE4RsgeHUV2MHQldFvU0prf6iFM+AzNUgjUmkdOOEY+Pea4iuQFKqbfGqtYhV4XgNKPAF/0QCsfAt4Iv8r5se3Vw7H6J/DEeJPxEs4TNihA9wOhfD/VwSG4mg4ZscjsRciHP0Lj1I/YSFm6AuFGHM/QDwG/ITl9xOLQICw9gOkFUD8V//Nh9xeIL7Y249bgX3y6SDEnL0DWJbxnfZiU0AAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"app concurrent render\" title=\"app concurrent render\" src=\"/static/967e05dc9dda1d2cd837d27accf2d848/2e237/app_concurrent_render.png\" srcset=\"/static/967e05dc9dda1d2cd837d27accf2d848/18f77/app_concurrent_render.png 198w,\n/static/967e05dc9dda1d2cd837d27accf2d848/2cb6c/app_concurrent_render.png 395w,\n/static/967e05dc9dda1d2cd837d27accf2d848/2e237/app_concurrent_render.png 790w,\n/static/967e05dc9dda1d2cd837d27accf2d848/f4281/app_concurrent_render.png 1016w\" sizes=\"(max-width: 790px) 100vw, 790px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>일반적으로 개발자가 업데이트를 생성하면 해당 업데이트는 동기식으로 렌더링을 진행합니다. 동기식은 업데이트가 렌더링을 시작했을 때 화면 반영까지 쭉 메인 스레드를 점유한 상태로 작업을 진행하는 방식입니다. 반면에 동시성 렌더링은 렌더링 과정이 비동기로 점진적으로 진행됩니다. 그래서 렌더링 작업이 동기식과는 다르게 잘게 쪼개져(Time Slicing) 있는 것을 확인할 수 있습니다. 여기에 우선순위 기반의 렌더링이 더해져 전환 렌더링 중이라도 우선순위가 더 높은 사용자 액션의 업데이트가 발생했다면 해당 업데이트를 먼저 렌더링하면서 사용자를 차단하지 않고 높은 응답성을 가질 수 있게 되었습니다. 리액트에서 전환 업데이트의 비동기식 점진적 렌더링을 Concurrent Render, 동기식을 Sync Render라고 합니다.</p>\n<p>단일 상태로 렌더링하는 것과 전환 업데이트로 나눈 것의 단일 업데이트, 순차적인 업데이트 생성 시의 렌더링 과정은 다음과 같습니다.</p>\n<video controls width=\"100%\">\n <source src=\"/path/to/dir/14314cf9f0b8206878cc1671afbb35a5/update_simul.mp4\" type=\"video/mp4\" />\n</video>\n<p><em>단일 업데이트 생성</em></p>\n<video controls width=\"100%\">\n <source src=\"/path/to/dir/7e711923b7771a651fcdf13bee39fb99/updates_simul.mp4\" type=\"video/mp4\" />\n</video>\n<p><em>짧은 간격으로 두 개의 업데이트 생성</em></p>\n<h1 id=\"증명을-위한-예제-코드\" style=\"position:relative;\"><a href=\"#%EC%A6%9D%EB%AA%85%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%98%88%EC%A0%9C-%EC%BD%94%EB%93%9C\" aria-label=\"증명을 위한 예제 코드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>증명을 위한 예제 코드</h1>\n<p>Transition Lane의 설명과 이를 증명하기 위해서는 렌더링 과정을 들여다보아야 합니다. 이를 위해서 다음의 케이스 실행기를 사용할 예정입니다.</p>\n<iframe src=\"https://codesandbox.io/embed/use-case-u928zv?expanddevtools=1&fontsize=14&hidenavigation=1&theme=dark&runonclick=1\"\n     style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n     title=\"use-case\"\n     allow=\"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking\"\n     sandbox=\"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts\"\n   ></iframe>\n<p>각 케이스별로 예제 코드와 버튼이 있습니다. 버튼을 클릭하면 케이스를 실행하고 로그를 찍습니다. <strong>case 1</strong>을 한번 실행시켜 보겠습니다.</p>\n<h2 id=\"로그-설명\" style=\"position:relative;\"><a href=\"#%EB%A1%9C%EA%B7%B8-%EC%84%A4%EB%AA%85\" aria-label=\"로그 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>로그 설명</h2>\n<p>로그는 렌더링 단계별(Render, Commit)로 묶이며, Render Phase에서는 컴포넌트의 렌더링 정보(렌더링 순서, 보류 상태)를 확인할 수 있습니다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 402px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 96.46464646464645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACx0lEQVQ4y21U2VIiQRCcLzCcPoYZBpVDQUSOUDkFBLwNQ9988P//ozazpGdx2YeMnqmu6q6syq4oz3NJkkThvVeUSiXJsqywcQ02ruG/XC4L43cRGWNkuVzKdDpV8Lvb7Uq1WpX5fK62m5sb6XQ6cnJyIpPJRK6vr3Xlv7W2SISIaOj3+xo4Ho9lsVhI++JCGqenMru9lTECudeDT73RkMFgIMPhUC+oVCpindODHIHv6BdlAsYSLsmwJsg+4UqKcSwZy8ESYF8pAzn2cpRCQcqhRgoG1+vir67EXV6KB3Vfq4lPU/HI1CE7f34uvtUST6rwdWDj2m1xKBFtEdNUMGVk4ZpNsY+PYr6+xD49/QSg+Pb9XSxq6kDdbjZ6gMOF9vlZXK8n7uxMHBhF/3YpRzY5bspxgSJQgrPa+Y8EcnaYvv+jXIA0jo6UAuko0BwPR80I2TvSRHNoY739jty0ywVlIlBGp+3b2w+10UjpWNAyn5+6Z+7uxEJK7vCw6G5AlCLtPcApxc26gora4JyCtq4E9wl0ejf274EM5ObxsaSgk8E54+ugDfVKQTkF/RQl0W/4pFBACi3+OpDCVuBWe3AgBtIwoGseHiT++JD45UXi11exOMCAbvz9rT4xaBtISeOQeTgn4vssgBsyZoCip9CagtngXzMlC+7RB81RJowJsVj3a8ggUmS9iFBT2ngoGqH/rCMyKuodKO8JG1nZ1UoFq13GO7Z4HQ4X2fVau29QAsNvlMXiRVnsORyuXf719PhNfaExHvLxoJeAcgKKqjfIx0M+fHrUIp8iE3BBk9Qh1R1mXHjPpJBth4BiOyNJ04Myh0fOwRCwfSXFPFwjfY4tYnN/L33cXIMkVrRjPk5AmzOyBepLdHc6m0kJ9SpKtSNulc0FBgCH6BWmDGdiE3Tr6OIIr4TDlPOPPrTTdom6kY3b0tzFH+iKAy9+oRFpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"render phase log\" title=\"render phase log\" src=\"/static/9ceca5b85dfd4a0b72ee4f514f7471ef/0ec92/render_phase_log.png\" srcset=\"/static/9ceca5b85dfd4a0b72ee4f514f7471ef/18f77/render_phase_log.png 198w,\n/static/9ceca5b85dfd4a0b72ee4f514f7471ef/2cb6c/render_phase_log.png 395w,\n/static/9ceca5b85dfd4a0b72ee4f514f7471ef/0ec92/render_phase_log.png 402w\" sizes=\"(max-width: 402px) 100vw, 402px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>Commit Phase가 끝나면 DOM에 반영됩니다. 반영된 DOM의 내용은 다음과 같이 출력됩니다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 790px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 17.67676767676768%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAiElEQVQY052PzQrDMAyD8xL22m00zY8dymjf/+20KpCyXXbYwUj+IhQcSik4jgPU7bVhfsyQm0AnhUzfOuYXD/u+o7UGbw57GrJmVKlYdYWJIWpEkdJ5loyk6eLMcec71cUR3M+iajA3pHtClNjDiy69lJ5herJPzk/iudOPXBgns7havc79d947BGpE9mpiOwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"commit phase log\" title=\"commit phase log\" src=\"/static/e769e93d39831c684015750fc0d903af/2e237/commit_phase_log.png\" srcset=\"/static/e769e93d39831c684015750fc0d903af/18f77/commit_phase_log.png 198w,\n/static/e769e93d39831c684015750fc0d903af/2cb6c/commit_phase_log.png 395w,\n/static/e769e93d39831c684015750fc0d903af/2e237/commit_phase_log.png 790w,\n/static/e769e93d39831c684015750fc0d903af/11b93/commit_phase_log.png 1124w\" sizes=\"(max-width: 790px) 100vw, 790px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<h2 id=\"컴포넌트\" style=\"position:relative;\"><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8\" aria-label=\"컴포넌트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컴포넌트</h2>\n<p>공통 컴포넌트는 <code class=\"language-text\">&lt;Text/></code>, <code class=\"language-text\">&lt;BusyText/></code>, <code class=\"language-text\">&lt;AsyncText/></code>, <code class=\"language-text\">&lt;AsyncBusyText/></code>가 있습니다.<br>\n<code class=\"language-text\">&lt;Text/></code>는 넘겨받은 값을 그대로 렌더링합니다.<br>\n<code class=\"language-text\">&lt;BusyText/></code>는 <code class=\"language-text\">&lt;Text/></code>와 같지만, 렌더링이 완료되기까지 3ms~가 걸립니다. 여러 번의 Render Phase가 진행되도록 하기 위한 컴포넌트입니다.<br>\n<code class=\"language-text\">&lt;Async**/></code>는 렌더링 보류 상태를 증명하기 위한 컴포넌트입니다. 이를 위해 내부적으로 &#x3C;Suspense /> 인터페이스를 구현한 Data fetch API를 사용합니다. fetch가 완료되지 않은 상태에서 렌더링이 되면 <code class=\"language-text\">\"Suspend [&lt;text>]\"</code> 로그를 찍고 렌더링을 보류합니다.</p>\n<h2 id=\"모듈-설명\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%93%88-%EC%84%A4%EB%AA%85\" aria-label=\"모듈 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모듈 설명</h2>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 312px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 168.18181818181816%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAiCAYAAABfqvm9AAAACXBIWXMAABYlAAAWJQFJUiTwAAAES0lEQVRIx5VWOW9jZRQ10izZ7bfafvbzvm84cWIndqIIhlWCCiRGUyIYBDOiAwmBpgAxopoKCYkSkKhoEBRMQUvHH6BEUCD+w+Ge+/I5tmMnTPHpW57ffeeee879HPM8D4mtDcQ3bsKxLTiuC9u24TgO+MyVPQfX/2fEHMvC+M0PdQTFKtLJJArFIjKZzBMFmga049t49Yvvcffx3yj2D9GqV3B8fIxarTZFuTiWfcicxbhIhXkE+aKk6sByfH3o+/4To+N7MV0Id7akHqQ9VAoekr6nPNpybsl5IpHQ2YzZPbPgb+cRpnxcX3fx4O0Qf/5UxdNNH0G2gG63g36/j729PfR6PbTbbZ15NhgMdF2tVvWcGU0R+oJoa8fFa8+n8eBuiFLeQ5groNNpo9VqTYM2m03d7+7u6rrT6WjQbrc7H5ALpnlzw0EsZsOyRSqSyrJ0r0xZEcqIJ1wcD1K4fzuDQuiJHn2k0ykkRUYRLSkEQaD7dDqtg+ulRUklPVxbc/D5vRB//VxDr+GhWG7g1rPP4PT0FAcHB5rWZDLBaDTC4eGhUkAeSQERTnVoFkyzU/cx2RMkKUGUDlASgefzeRQKBUWYzWYRhqHORFupVC4YYMohC7O+5eKpG8KJE8kmHo9P+TJ2nB2LFp0GTErKa5su3nk9g1+/KqFV9ZAJCyKJiiIsClIiW2XFCwijgA7ev5PFj49KaJQ9lCsNHAlXtOFwOFSJGK5mAyx+JDZ7aFmu6tF0GGqLXJG/qzx8oSiO46KY87DfEVmkvMjXVkJ5nOXKOdOne9bmlqZsZPPZeyH++aUm1vOQK1RFIkOVBgctxpnSoVRIAd0yK5lzYUuFt+MuXjpO494bWRV2kAlVe7QWWxmLQ5nQt41GAx15xv1ii5uz3o31c+s5jq2SYcpGNsZ2USeyV6d8jjClaZelhbleUq3HotBmLIyx36VFUZ8Kh9eFw0/fDfHHD1V0655cAzXha4zxeKzcUT5MlzPTX4ZuGlCr5/mCzBf7RVX2RDK0mEFn7EYbmla19E7RYNKZE5vrSMQtSd0Rnqw53gx3Zphgy4LG7EQcL3z0JV55+B1yzR5y2UCqWtfK0vjlchn1erRndWnBVZfXWcAdPPfBI9z55jfk23299YbSotimGIyyYbui/Tgz8KL2lqbM63Rnx1JPW5ajsiESpmU6y2xnXsmhecCW1aom8eJEChBwfx6IHLIQ7NDmIys5NLK5tubi4f0Q/z6uoS+3XjZXxsH+AKPhSNMtlUpqOVJxGY9zd8rJfgq3Xw4QZmi9rBaDhaBnGZB9kR6mlC6VzXLrOXNSMemb9ao/UlGDlWCb29G9/PXHedRKtB7FnFHpcPB3dIgR+KUIySHRffJWiN+/raBTk5elfR0dRR375ORE0yeH5rZbJZ3YrMlZ3WLOl4pG3drcv7QeC0GkRMj9lRxG0nGjfw2uN9XfrBZn96s4/A8dHI3mFd2AQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"usecase structure\" title=\"usecase structure\" src=\"/static/023721b6d818c08ef0d9327da3e7baae/17474/usecase_structure.png\" srcset=\"/static/023721b6d818c08ef0d9327da3e7baae/18f77/usecase_structure.png 198w,\n/static/023721b6d818c08ef0d9327da3e7baae/17474/usecase_structure.png 312w\" sizes=\"(max-width: 312px) 100vw, 312px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<h3 id=\"src\" style=\"position:relative;\"><a href=\"#src\" aria-label=\"src permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>src</h3>\n<ul>\n<li>components: 공통 컴포넌트가 위치합니다.</li>\n<li>data-fetch: &#x3C;Suspense/> 인터페이스를 구현한 fake data fetch API입니다.</li>\n<li>log: 로그 모듈입니다.</li>\n<li>react-libs: 리액트 내부 의존성이 있는 모듈입니다.</li>\n<li>runner: use case 실행기입니다. 리액트의 profiling API를 활용하여 렌더링 시점을 잡습니다.</li>\n</ul>\n<h3 id=\"use-cases\" style=\"position:relative;\"><a href=\"#use-cases\" aria-label=\"use cases permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>use-cases</h3>\n<p>use case에는 예제용 App 컴포넌트<up>13</up>와 케이스 코드<up>47</up>가 있습니다.</p>\n<iframe src=\"https://codesandbox.io/embed/use-case-u928zv?fontsize=14&hidenavigation=1&module=%2Fuse-cases%2Fcase_1.js&theme=dark&view=editor&runonclick=1&highlights=13,47&codemirror=1\"\n     style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n     title=\"use-case\"\n     allow=\"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking\"\n     sandbox=\"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts\"\n   ></iframe>\n<p>케이스 코드에는 렌더링 단계별 yielding 포인트가 있습니다. 원하는 테스트 동작을 한 후, 캐치하려는 단계를 명시합니다.</p>\n<p>가령, 첫 마운트 이후의 시점을 잡고 싶다면 다음과 같이 작성합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">vdomRoot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">yield</span> <span class=\"token constant\">PHASE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">COMMIT</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 여기서 부터는 첫 Commit이 완료된 이후의 시점이 됩니다.</span></code></pre></div>\n<p><code class=\"language-text\">&lt;AsyncText/></code>를 사용했다면 데이터 요청을 완료하고 싶을 수 있습니다. resource API을 통해 요청 중인 데이터를 resolve 할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> resource <span class=\"token keyword\">from</span> <span class=\"token string\">'../src/data-fetch'</span>\nresource<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>케이스 별로 코드에 설명이 포함되어 있습니다. 필수적으로 확인하시길 바랍니다.</p>\n<h3 id=\"case-2\" style=\"position:relative;\"><a href=\"#case-2\" aria-label=\"case 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>case 2</h3>\n<p>가볍게 전환 업데이트가 정말 Time Slicing 되는지 확인해보겠습니다. 일반 업데이트와 전환 업데이트를 생성한 후 Render Phase가 몇 번 진행되는지 확인해보면 됩니다.</p>\n<iframe src=\"https://codesandbox.io/embed/use-case-u928zv?expanddevtools=1&fontsize=14&hidenavigation=1&theme=dark&module=%2Fuse-cases%2Fcase_2.js&runonclick=1\"\n     style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n     title=\"use-case\"\n     allow=\"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking\"\n     sandbox=\"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts\"\n   ></iframe>\n<blockquote>\n<p>케이스별 설명은 코드에 작성되어 있습니다.\ncase_2의 코드는 왼쪽 Resize Bar를 움직이거나 Open Sandbox 버튼을 통해 프로젝트에 직접 접근하여 확인할 수 있습니다.</p>\n</blockquote>\n<p>사전준비는 모두 끝났습니다. 이제 본격적으로 Transition Lane을 시작합니다.</p>","frontmatter":{"title":"React 18 톺아보기 - 03. Transition Lane_1","date":"2023-05-02","keywords":["리액트","react","react 18","concurrent render","lane","lane model","transition","transition lane"]}}},"pageContext":{"slug":"/react/in-depth-react18-transition_1/","previous":{"fields":{"slug":"/react/in-depth-react18-lane/"},"frontmatter":{"title":"React 18 톺아보기 - 02. Lane 모델","category":"react"}},"next":{"fields":{"slug":"/react/in-depth-react18-transition_2/"},"frontmatter":{"title":"React 18 톺아보기 - 03. Transition Lane_2","category":"react"}}}},"staticQueryHashes":["2277278352","536400264"]}